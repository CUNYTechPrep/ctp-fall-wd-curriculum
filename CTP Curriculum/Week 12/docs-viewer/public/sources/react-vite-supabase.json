{
  "project": "react-vite-supabase",
  "fileCount": 26,
  "files": [
    {
      "path": "LEARNING_GUIDE.md",
      "content": "# React + Vite + Supabase - Learning Guide\n\n## üéØ Project Overview\n\nA client-side SPA with PostgreSQL database - combining simplicity of React + Vite with power of SQL.\n\n## üîë Key Features & Implementation Details\n\n### Cross-Cutting Concerns\n\n**Architecture:**\n- Implementation: **Single Page Application (SPA) with PostgreSQL**\n- Pattern: Client-side only, PostgreSQL via Supabase\n- Deployment: Static files\n- Features: Simple + Powerful\n\n**Build Tool:**\n- Implementation: Vite\n- Location: `vite.config.ts`\n- Pattern: Fast HMR, optimized builds\n- Features: Instant dev server, code splitting\n\n**Routing:**\n- Implementation: React Router DOM v6\n- Location: `src/App.tsx`\n- Pattern: Client-side routing\n- Features: Protected routes, lazy loading\n\n**Authentication:**\n- Implementation: Supabase Auth (client-side)\n- Location: `src/lib/supabase.ts`, `src/contexts/AuthContext.tsx`\n- Pattern: localStorage sessions\n- Features: Email/password, auto-refresh\n\n**Database:**\n- Implementation: **PostgreSQL via Supabase**\n- Location: `src/lib/supabase.ts` (queries in components)\n- Pattern: Client queries with RLS protection\n- Features: SQL database from browser!\n\n**Security:**\n- Implementation: **Row Level Security (RLS)**\n- Pattern: Database-level access control\n- Features: Policies enforce security at source\n\n**Real-time:**\n- Implementation: Supabase Realtime (PostgreSQL)\n- Pattern: postgres_changes subscriptions\n- Features: Live updates, low latency\n\n## üìö Learning Flows\n\n### Flow 1: PostgreSQL from the Browser (20 minutes)\n\n**Goal:** Understand how PostgreSQL works in a SPA\n\n**Path:**\n1. **Start:** `src/lib/supabase.ts`\n   - Supabase client initialization\n   - PostgreSQL connection via REST API\n   - localStorage for sessions\n   - How RLS protects data\n\n2. **Next:** `src/pages/Dashboard.tsx`\n   - Direct PostgreSQL queries from browser\n   - .from('todos').select()\n   - RLS automatically filtering\n   - Type-safe queries\n\n3. **Understand:** How this is secure\n   - RLS policies in database\n   - Can't bypass from client\n   - Database is the security layer\n\n**Key Concepts:**\n- PostgreSQL from browser (unique!)\n- Supabase REST API\n- Row Level Security\n- Client-side SQL queries\n\n**Audio Guide:** `audio/01-postgresql-in-browser.mp3`\n\n---\n\n### Flow 2: Supabase Client in SPA (15 minutes)\n\n**Goal:** Learn Supabase client-side patterns\n\n**Path:**\n1. **Start:** `src/lib/supabase.ts`\n   - createClient for browser\n   - Configuration options\n   - localStorage storage\n\n2. **Next:** `src/contexts/AuthContext.tsx`\n   - Auth state management\n   - onAuthStateChange\n   - Session persistence\n\n3. **Then:** Any page with queries\n   - Direct database queries\n   - { data, error } pattern\n   - Type-safe operations\n\n**Key Concepts:**\n- Supabase client in SPA\n- localStorage vs cookies\n- Session management\n- Client-side queries\n\n**Audio Guide:** `audio/02-supabase-client-spa.mp3`\n\n---\n\n### Flow 3: Row Level Security (RLS) from Client (20 minutes)\n\n**Goal:** Understand database-level security\n\n**Path:**\n1. **Start:** Review RLS concept\n   - Database enforces security\n   - Policies filter queries\n   - auth.uid() in policies\n\n2. **Next:** `src/pages/Dashboard.tsx`\n   - Query all todos\n   - RLS automatically filters to user's\n   - Try to access others' data (blocked!)\n\n3. **Understand:** Security model\n   - Client protection is UX\n   - Database protection is security\n   - RLS can't be bypassed\n\n**Key Concepts:**\n- Row Level Security\n- Database-level security\n- auth.uid() function\n- Client vs database security\n\n**Audio Guide:** `audio/03-rls-from-client.mp3`\n\n---\n\n### Flow 4: Real-time with PostgreSQL (15 minutes)\n\n**Goal:** Learn Supabase Realtime\n\n**Path:**\n1. **Start:** `src/pages/Dashboard.tsx`\n   - Channel creation\n   - postgres_changes subscription\n   - Event handling\n   - Cleanup\n\n2. **Next:** `src/pages/Messages.tsx`\n   - Real-time messaging\n   - INSERT event listening\n   - Optimistic updates\n\n**Key Concepts:**\n- Supabase Realtime channels\n- postgres_changes events\n- WebSocket connections\n- Subscription cleanup\n\n**Audio Guide:** `audio/04-realtime-postgresql.mp3`\n\n---\n\n### Flow 5: Type Generation from Database (15 minutes)\n\n**Goal:** Learn type-safe Supabase queries\n\n**Path:**\n1. **Understand:** Type generation process\n   ```bash\n   npx supabase gen types typescript --project-id YOUR_ID > src/lib/database.types.ts\n   ```\n\n2. **See:** How types are used\n   - Import Database type\n   - Table row types\n   - Insert types\n   - Update types\n\n3. **Then:** `src/pages/Dashboard.tsx`\n   - Type-safe queries\n   - Autocomplete\n   - Compile-time errors\n\n**Key Concepts:**\n- Type generation from database\n- Database-driven types\n- Type-safe queries\n- Autocomplete benefits\n\n**Audio Guide:** `audio/05-type-generation.mp3`\n\n---\n\n### Flow 6: Components in SPA (15 minutes)\n\n**Goal:** React component patterns\n\n**Path:**\n1. **Start:** `src/components/TodoForm.tsx`\n   - Controlled inputs\n   - Supabase insert\n   - Form validation\n\n2. **Next:** `src/components/TodoList.tsx`\n   - List rendering\n   - Inline TodoItem\n   - Props and callbacks\n\n3. **Then:** `src/components/Layout.tsx`\n   - Layout composition\n   - Navigation\n   - Children prop\n\n**Key Concepts:**\n- Component composition\n- Controlled forms\n- Props and callbacks\n- Layout patterns\n\n**Audio Guide:** `audio/06-component-patterns.mp3`\n\n---\n\n### Flow 7: Static Deployment (10 minutes)\n\n**Goal:** Deploy SPA to production\n\n**Path:**\n1. **Start:** `vite.config.ts`\n   - Build configuration\n   - Output optimization\n\n2. **Next:** Build the app\n   ```bash\n   npm run build\n   ```\n   - See dist/ output\n   - Hashed filenames\n   - Optimized bundles\n\n3. **Then:** Deploy options\n   - Vercel, Netlify, Firebase Hosting\n   - Static file hosting\n   - Environment variables\n\n**Key Concepts:**\n- Production builds\n- Static deployment\n- SPA routing fallback\n- CDN deployment\n\n**Audio Guide:** `audio/07-static-deployment.mp3`\n\n---\n\n## üéì Recommended Learning Order\n\n### Beginner (Learn SPA Basics) - 3-5 hours\n1. Flow 1: Vite Setup (15 min)\n2. Flow 2: React Router (20 min)\n3. Flow 6: Components (15 min)\n4. Experiment with React (2-4 hours)\n\n### Intermediate (Add Database) - 5-7 hours\n1. Complete Beginner Path\n2. Flow 3: RLS Security (20 min)\n3. Flow 4: Real-time (15 min)\n4. Build features (4-6 hours)\n\n### Advanced (Type Safety & Deploy) - 7-9 hours\n1. Complete Intermediate Path\n2. Flow 5: Type Generation (15 min)\n3. Flow 7: Deployment (10 min)\n4. Build complete app (6-8 hours)\n\n## üåü Why This Stack\n\n**Unique combination:**\n- React + Vite: Simple, fast SPA\n- Supabase PostgreSQL: SQL power from browser\n- Open-source: Can self-host everything\n- Type-safe: Generated types from database\n\n**Best for:**\n- Learning React + PostgreSQL\n- Internal tools and dashboards\n- Open-source projects\n- Simple deployment needs\n\n## üîó Quick Reference\n\n### Core Files\n- **Vite:** `vite.config.ts`\n- **Supabase:** `src/lib/supabase.ts`\n- **Router:** `src/App.tsx`\n- **Auth:** `src/contexts/AuthContext.tsx`\n\n### Pages\n- Landing: `src/pages/Landing.tsx`\n- Auth: `src/pages/SignIn.tsx`, `SignUp.tsx`\n- Dashboard: `src/pages/Dashboard.tsx`\n- Feed: `src/pages/Feed.tsx`\n- Messages: `src/pages/Messages.tsx`\n- Settings: `src/pages/Settings.tsx`\n\n### Components\n- TodoForm: `src/components/TodoForm.tsx`\n- TodoList: `src/components/TodoList.tsx`\n- Layout: `src/components/Layout.tsx`\n- ProtectedRoute: `src/components/ProtectedRoute.tsx`\n\n---\n\n**Start with Flow 1 to understand the SPA + PostgreSQL combination!**\n\n**Audio overviews in `audio/` folder (coming soon).**\n",
      "language": "markdown"
    },
    {
      "path": "README.md",
      "content": "# React + Vite + Supabase Todo Application\n\nA client-side todo application built with React, Vite, and Supabase.\n\n## Features\n\n- User authentication (sign up, sign in, sign out)\n- Todo CRUD operations with real-time updates\n- User accessibility settings\n- Profile picture uploads\n- Todo file attachments\n- Public feed (searchable, filterable, paginated)\n- Real-time messaging\n- Tags for categorization\n- PostgreSQL database with Row Level Security\n\n## Tech Stack\n\n- **Framework:** React 18\n- **Build Tool:** Vite\n- **Language:** TypeScript\n- **Styling:** Tailwind CSS\n- **Routing:** React Router DOM\n- **Authentication:** Supabase Auth\n- **Database:** PostgreSQL (via Supabase)\n- **Storage:** Supabase Storage\n- **Real-time:** Supabase Realtime\n\n## Why This Stack?\n\n**Perfect Combination:**\n- ‚úÖ **Simple frontend** (React + Vite)\n- ‚úÖ **Powerful backend** (PostgreSQL)\n- ‚úÖ **Open-source** (can self-host)\n- ‚úÖ **Type-safe** (generate types from database)\n- ‚úÖ **Real-time** built-in\n- ‚úÖ **Cheap** hosting (static files + Supabase free tier)\n\n**Best For:**\n- Internal tools and dashboards\n- CRUD applications\n- Real-time collaborative apps\n- Learning modern web development\n- Projects needing SQL database\n\n## Getting Started\n\n### Prerequisites\n\n- Node.js 18+\n- Supabase project (free tier available)\n\n### Setup\n\n1. **Install Dependencies:**\n   ```bash\n   npm install\n   ```\n\n2. **Environment Variables:**\n   Create `.env` file:\n   ```env\n   VITE_SUPABASE_URL=https://your-project.supabase.co\n   VITE_SUPABASE_ANON_KEY=your-anon-key\n   ```\n   Get these from Supabase Dashboard ‚Üí Project Settings ‚Üí API\n\n3. **Set Up Database:**\n   Run these SQL commands in Supabase SQL Editor:\n\n   ```sql\n   -- Create tables (see database-schema.sql in project)\n   -- Enable Row Level Security\n   -- Create RLS policies\n   ```\n\n4. **Generate Types (Optional but Recommended):**\n   ```bash\n   npx supabase gen types typescript --project-id YOUR_PROJECT_ID > src/lib/database.types.ts\n   ```\n\n5. **Run Development Server:**\n   ```bash\n   npm run dev\n   ```\n   Open [http://localhost:5173](http://localhost:5173)\n\n## Project Structure\n\n```\nreact-vite-supabase/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ components/          # React components\n‚îÇ   ‚îú‚îÄ‚îÄ contexts/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx  # Supabase auth management\n‚îÇ   ‚îú‚îÄ‚îÄ hooks/              # Custom React hooks\n‚îÇ   ‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts     # Supabase client\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.types.ts  # Generated types\n‚îÇ   ‚îú‚îÄ‚îÄ pages/              # Page components\n‚îÇ   ‚îú‚îÄ‚îÄ App.tsx             # Root with routes\n‚îÇ   ‚îî‚îÄ‚îÄ main.tsx            # Entry point\n‚îú‚îÄ‚îÄ .env                    # Environment variables\n‚îú‚îÄ‚îÄ index.html\n‚îî‚îÄ‚îÄ vite.config.ts\n```\n\n## Database Schema\n\nSee `database-schema.sql` for complete schema.\n\n**Tables:**\n- `user_profiles` - Extended user data\n- `user_settings` - Accessibility preferences\n- `todos` - Todo items\n- `todo_attachments` - File metadata\n- `messages` - Real-time messaging\n\n**Row Level Security:**\nAll tables have RLS policies ensuring users can only access their own data (or public data where appropriate).\n\n## Type Safety\n\nGenerate TypeScript types from your database:\n\n```bash\nnpx supabase gen types typescript --project-id YOUR_PROJECT_ID > src/lib/database.types.ts\n```\n\nThen enjoy full autocomplete:\n\n```typescript\nimport { supabase } from '@/lib/supabase'\n\nconst { data } = await supabase\n  .from('todos') // ‚úÖ Autocomplete table names\n  .select('title, completed') // ‚úÖ Autocomplete column names\n  .eq('user_id', userId) // ‚úÖ Type-checked values\n```\n\n## Real-time Subscriptions\n\nSubscribe to database changes:\n\n```typescript\nconst channel = supabase\n  .channel('todos')\n  .on('postgres_changes', {\n    event: '*',\n    schema: 'public',\n    table: 'todos',\n    filter: `user_id=eq.${userId}`\n  }, (payload) => {\n    console.log('Todo changed:', payload)\n    // Update UI\n  })\n  .subscribe()\n\n// Cleanup\nreturn () => supabase.removeChannel(channel)\n```\n\n## Authentication\n\nSupabase Auth is built-in:\n\n```typescript\n// Sign up\nconst { data, error } = await supabase.auth.signUp({\n  email,\n  password,\n  options: {\n    data: { display_name: displayName }\n  }\n})\n\n// Sign in\nconst { data, error } = await supabase.auth.signInWithPassword({\n  email,\n  password\n})\n\n// Sign out\nawait supabase.auth.signOut()\n\n// Listen for auth changes\nsupabase.auth.onAuthStateChange((event, session) => {\n  // Update UI\n})\n```\n\n## Building for Production\n\n```bash\nnpm run build\n```\n\nCreates optimized static files in `dist/`.\n\n## Deployment\n\n### Vercel\n```bash\nnpx vercel\n```\n\n### Netlify\n```bash\nnpx netlify deploy --prod\n```\n\n### Other Hosts\nUpload `dist/` to any static host:\n- Firebase Hosting\n- GitHub Pages\n- Cloudflare Pages\n- AWS S3 + CloudFront\n\n**Environment Variables:**\nSet in your hosting platform:\n- `VITE_SUPABASE_URL`\n- `VITE_SUPABASE_ANON_KEY`\n\n## Row Level Security Example\n\n```sql\n-- Users can only see their own todos\nCREATE POLICY \"Users see own private todos\"\nON todos FOR SELECT\nUSING (\n  auth.uid() = user_id\n  OR is_public = true\n);\n\n-- Users can only create their own todos\nCREATE POLICY \"Users create own todos\"\nON todos FOR INSERT\nWITH CHECK (auth.uid() = user_id);\n\n-- Users can only update their own todos\nCREATE POLICY \"Users update own todos\"\nON todos FOR UPDATE\nUSING (auth.uid() = user_id);\n```\n\n## Comparison with Other Stacks\n\n| Feature | React + Vite + Supabase | React + Vite + Firebase | Next.js + Supabase |\n|---------|------------------------|-------------------------|-------------------|\n| Database | PostgreSQL (SQL) | Firestore (NoSQL) | PostgreSQL (SQL) |\n| Rendering | Client-side (SPA) | Client-side (SPA) | SSR + CSR |\n| SEO | Poor | Poor | Excellent |\n| Complexity | Simple | Simple | More complex |\n| Deployment | Static files | Static files | Node.js server |\n| Open Source | Yes | No | Backend only |\n| Cost | Very cheap | Cheap | More expensive |\n\n## Learn More\n\n- [React Documentation](https://react.dev/)\n- [Vite Documentation](https://vitejs.dev/)\n- [Supabase Documentation](https://supabase.com/docs)\n- [React Router](https://reactrouter.com/)\n- [PostgreSQL](https://www.postgresql.org/docs/)\n\n## License\n\nMIT\n",
      "language": "markdown"
    },
    {
      "path": "package.json",
      "content": "{\n  \"name\": \"react-vite-supabase-todo\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"tsc && vite build\",\n    \"preview\": \"vite preview\",\n    \"lint\": \"eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0\"\n  },\n  \"dependencies\": {\n    \"react\": \"^18.3.1\",\n    \"react-dom\": \"^18.3.1\",\n    \"react-router-dom\": \"^6.20.0\",\n    \"@supabase/supabase-js\": \"^2.38.4\"\n  },\n  \"devDependencies\": {\n    \"@types/react\": \"^18.2.37\",\n    \"@types/react-dom\": \"^18.2.15\",\n    \"@typescript-eslint/eslint-plugin\": \"^6.10.0\",\n    \"@typescript-eslint/parser\": \"^6.10.0\",\n    \"@vitejs/plugin-react\": \"^4.2.0\",\n    \"autoprefixer\": \"^10.4.16\",\n    \"eslint\": \"^8.53.0\",\n    \"eslint-plugin-react-hooks\": \"^4.6.0\",\n    \"eslint-plugin-react-refresh\": \"^0.4.4\",\n    \"postcss\": \"^8.4.31\",\n    \"tailwindcss\": \"^3.3.5\",\n    \"typescript\": \"^5.2.2\",\n    \"vite\": \"^5.0.0\"\n  }\n}\n",
      "language": "json"
    },
    {
      "path": "postcss.config.js",
      "content": "/**\n * REF: PostCSS Configuration for Tailwind CSS\n *\n * PostCSS processes CSS transformations via plugins.\n * This config enables Tailwind CSS and browser compatibility.\n *\n * CLOSE: Vite uses this config automatically when processing CSS files.\n * No manual invocation needed - runs during build and dev server.\n */\nexport default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n// CLOSE: PostCSS Configuration for Tailwind CSS\n",
      "language": "javascript"
    },
    {
      "path": "src/App.tsx",
      "content": "/**\n * REF: Root Application Component\n *\n * Main entry point for the React + Vite + Supabase application.\n * Sets up authentication context, routing, and code splitting for all pages.\n *\n * CLOSE: This component wraps the entire app with AuthProvider and BrowserRouter.\n * It defines all routes (public and protected) and lazy loads page components.\n *\n * ## Architecture\n * | `Layer` | `Technology` | Purpose |\n * |-------|-----------|---------|\n * | `Provider` | AuthContext (Supabase) | Global authentication state |\n * | `Router` | React Router v6 | Client-side routing and navigation |\n * | Code Splitting | React.lazy + Suspense | Load pages on demand |\n * | `Protection` | ProtectedRoute component | Auth guards for private pages |\n * | `Styling` | Tailwind CSS | Responsive design and theming |\n *\n * ROUTING STRUCTURE:\n * | `Path` | `Component` | `Protected` | Purpose |\n * |------|-----------|-----------|---------|\n * | / | `Landing` | `No` | Public home page |\n * | /signin | `SignIn` | `No` | Authentication page |\n * | /signup | `SignUp` | `No` | Account creation |\n * | /dashboard | `Dashboard` | `Yes` | User's todos CRUD |\n * | /feed | `Feed` | `Yes` | Browse public todos |\n * | /messages | `Messages` | `Yes` | Real-time messaging |\n * | /settings | `Settings` | `Yes` | User preferences |\n * | * | Navigate / | `No` | 404 redirect to home |\n *\n * ## Tech Stack\n * - React 18 with Concurrent Features\n * - React Router v6 for client-side navigation\n * - React.lazy for code splitting\n * - Supabase Auth (via AuthContext)\n * - TypeScript for type safety\n *\n * ## Key Concepts\n * - SPA with client-side routing (no server routing)\n * - Protected routes via Supabase session validation\n * - Code splitting reduces initial bundle size\n * - LoadingFallback for lazy-loaded pages\n * - RLS ensures database-level security (not just UI)\n *\n * PROTECTED ROUTE FLOW:\n * 1. ProtectedRoute component checks useAuth() hook\n * 2. If loading, show LoadingFallback spinner\n * 3. If not authenticated, redirect to /signin\n * 4. Otherwise, render children component\n * 5. Even if bypassed, RLS policies block unauthorized database access\n *\n * ## Code Splitting Benefits\n * - Initial bundle only includes Landing, SignIn, SignUp\n * - Other pages loaded only when user navigates to them\n * - Faster app startup and better caching\n */\n\nimport { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom'\nimport { AuthProvider, useAuth } from './contexts/AuthContext'\nimport { lazy, Suspense } from 'react'\n\n// Lazy load pages for better performance\nconst Landing = lazy(() => import('./pages/Landing'))\nconst SignIn = lazy(() => import('./pages/SignIn'))\nconst SignUp = lazy(() => import('./pages/SignUp'))\nconst Dashboard = lazy(() => import('./pages/Dashboard'))\nconst Feed = lazy(() => import('./pages/Feed'))\nconst Messages = lazy(() => import('./pages/Messages'))\nconst Settings = lazy(() => import('./pages/Settings'))\n\n/**\n * REF: loading-fallback-component\n *\n * ## Loading Fallback Component\n *\n * Displayed while lazy-loaded pages download and render.\n *\n * ### Purpose\n * - Show user something is loading\n * - Prevent blank screen during page load\n * - Consistent loading experience across app\n *\n * ### When Shown\n * - User navigates to lazy-loaded page\n * - Page chunk downloads from server\n * - Component renders with Suspense\n *\n * ### UX Considerations\n * - Keep it simple (just spinner or text)\n * - Use consistent styling with app theme\n * - Consider skeleton screens for better UX\n * - Keep load times under 1 second when possible\n */\nfunction LoadingFallback() {\n  return (\n    <div className=\"flex min-h-screen items-center justify-center\">\n      <div className=\"text-xl\">Loading...</div>\n    </div>\n  )\n}\n// CLOSE: loading-fallback-component\n\n/**\n * REF: protected-route-wrapper\n *\n * ## Protected Route Component\n *\n * Client-side route guard for authenticated pages.\n *\n * ### How It Works\n * 1. Gets user and loading state from useAuth() hook\n * 2. While loading: shows LoadingFallback (prevents redirect flashing)\n * 3. If no user: redirects to /signin with Navigate component\n * 4. If user exists: renders children component safely\n *\n * ### Key Parameters\n * - `children`: Protected component to render if authenticated\n *\n * ### Important Note: UX vs Security\n * | Aspect | Status |\n * |--------|--------|\n * | User Experience | Good (prevents seeing login UI) |\n * | True Security | Database-level (RLS policies) |\n * | Can Be Bypassed | Yes (disable JS, modify history) |\n * | Purpose | Improve UX, not protect data |\n *\n * **Real Security Layers:**\n * 1. RLS policies in PostgreSQL\n * 2. Supabase JWT verification\n * 3. Database query filters\n * 4. Client-side route guard (last line of defense)\n *\n * **Why This Works:**\n * Even if attacker bypasses client-side protection:\n * - Database RLS policies prevent data access\n * - Backend auth middleware validates JWT\n * - Queries return only authorized data\n * - Client code can't override security\n *\n * ### Usage Pattern\n * ```tsx\n * <Route\n *   path=\"/dashboard\"\n *   element={\n *     <ProtectedRoute>\n *       <Dashboard />\n *     </ProtectedRoute>\n *   }\n * />\n * ```\n *\n * ### React Router Navigate\n * - `<Navigate to=\"/signin\">`: Programmatic redirect\n * - `replace={true}`: Don't add to history (can't go back)\n * - `state={{ from: location }}`: Can pass location for return after login\n *\n * ### Client-Side Auth Check Timing\n * 1. App mounts\n * 2. AuthContext checks localStorage for session\n * 3. Calls getSession() to validate token\n * 4. If valid, user is set, loading becomes false\n * 5. Protected route renders based on user state\n * 6. If invalid, user is null, redirects to signin\n */\nfunction ProtectedRoute({ children }: { children: React.ReactNode }) {\n  const { user, loading } = useAuth()\n\n  /**\n   * LOADING STATE HANDLING\n   *\n   * Show spinner while auth is checking\n   * Prevents flashing redirect to signin\n   */\n  if (loading) {\n    return <LoadingFallback />\n  }\n\n  /**\n   * REDIRECT IF UNAUTHENTICATED\n   *\n   * User is null after auth check complete\n   * Redirect to signin, don't add to history\n   */\n  if (!user) {\n    return <Navigate to=\"/signin\" replace />\n  }\n\n  /**\n   * RENDER PROTECTED CONTENT\n   *\n   * User exists and is authenticated\n   * Safe to show protected component\n   */\n  return <>{children}</>\n}\n// CLOSE: protected-route-wrapper\n\n/**\n * REF: app-component-root\n *\n * ## Root App Component\n *\n * Assembles the entire application with providers and routing.\n *\n * ### Provider Stack (Order Matters!)\n *\n * ```\n * AuthProvider (outermost)\n * ‚îú‚îÄ Manages global auth state\n * ‚îú‚îÄ Initializes Supabase session\n * ‚îú‚îÄ Listens for auth changes\n * ‚îÇ\n * ‚îî‚îÄ BrowserRouter\n *    ‚îú‚îÄ Enables React Router\n *    ‚îú‚îÄ Manages URL state\n *    ‚îî‚îÄ Provides navigation context\n *       ‚îÇ\n *       ‚îî‚îÄ Suspense\n *          ‚îú‚îÄ Catches lazy loading fallback\n *          ‚îú‚îÄ Shows LoadingFallback while chunks load\n *          ‚îÇ\n *          ‚îî‚îÄ Routes\n *             ‚îú‚îÄ / (Landing - public)\n *             ‚îú‚îÄ /signin (SignIn - public)\n *             ‚îú‚îÄ /signup (SignUp - public)\n *             ‚îú‚îÄ /dashboard (Dashboard - protected)\n *             ‚îú‚îÄ /feed (Feed - protected)\n *             ‚îú‚îÄ /messages (Messages - protected)\n *             ‚îú‚îÄ /settings (Settings - protected)\n *             ‚îî‚îÄ * (404 redirect to /)\n * ```\n *\n * ### Route Categories\n *\n * **Public Routes (no auth required):**\n * - `/`: Landing page (marketing/info)\n * - `/signin`: Login form\n * - `/signup`: Registration form\n *\n * **Protected Routes (auth required):**\n * - `/dashboard`: User's personal todos\n * - `/feed`: Public todos from all users\n * - `/messages`: Direct messaging\n * - `/settings`: User preferences\n *\n * **Catch-all Route:**\n * - `*`: Any unmatched route redirects to `/`\n *\n * ### Code Splitting Strategy\n *\n * Each page is lazy-loaded:\n * - Initial bundle: Landing, SignIn, SignUp only\n * - Dashboard chunk: Downloaded when user navigates\n * - Feed chunk: Downloaded separately\n * - Messages chunk: Downloaded on demand\n * - Settings chunk: Downloaded when accessed\n *\n * **Benefits:**\n * - Smaller initial bundle (faster first page load)\n * - Faster time-to-interactive\n * - Lazy chunks cached separately\n * - Users only download pages they visit\n *\n * ### Component Composition\n * - AuthProvider provides user context globally\n * - ProtectedRoute wraps protected pages\n * - LoadingFallback shown while pages load\n * - Suspense component catches lazy errors\n */\nexport default function App() {\n  return (\n    <AuthProvider>\n      <BrowserRouter>\n        <Suspense fallback={<LoadingFallback />}>\n          <Routes>\n            {/* Public Routes - No authentication required */}\n            <Route path=\"/\" element={<Landing />} />\n            <Route path=\"/signin\" element={<SignIn />} />\n            <Route path=\"/signup\" element={<SignUp />} />\n\n            {/* Protected Routes - Require authentication */}\n            <Route\n              path=\"/dashboard\"\n              element={\n                <ProtectedRoute>\n                  <Dashboard />\n                </ProtectedRoute>\n              }\n            />\n            <Route\n              path=\"/feed\"\n              element={\n                <ProtectedRoute>\n                  <Feed />\n                </ProtectedRoute>\n              }\n            />\n            <Route\n              path=\"/messages\"\n              element={\n                <ProtectedRoute>\n                  <Messages />\n                </ProtectedRoute>\n              }\n            />\n            <Route\n              path=\"/settings\"\n              element={\n                <ProtectedRoute>\n                  <Settings />\n                </ProtectedRoute>\n              }\n            />\n\n            {/* 404 Catch-all - Redirect unmatched routes to home */}\n            <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n          </Routes>\n        </Suspense>\n      </BrowserRouter>\n    </AuthProvider>\n  )\n}\n// CLOSE: app-component-root\n\n/**\n * SUPABASE IN CLIENT-SIDE APP\n *\n * All operations happen in the browser:\n *\n * ```typescript\n * import { supabase } from './lib/supabase'\n *\n * // Queries run from browser\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *\n * // RLS automatically enforced\n * // User can only see their data\n * ```\n *\n * ## Advantages\n * - Simple architecture\n * - No server needed\n * - Deploy as static files\n * - Cheap hosting\n *\n * ## Security\n * - RLS enforced at database\n * - Auth tokens in localStorage\n * - HTTPS required for production\n */\n\n/**\n * REAL-TIME IN CLIENT-SIDE APP\n *\n * Supabase Realtime works great in SPAs:\n *\n * ```typescript\n * useEffect(() => {\n *   const channel = supabase\n *     .channel('todos')\n *     .on('postgres_changes', {\n *       event: '*',\n *       schema: 'public',\n *       table: 'todos'\n *     }, handleChange)\n *     .subscribe()\n *\n *   return () => supabase.removeChannel(channel)\n * }, [])\n * ```\n *\n * Works across all browser tabs and devices!\n */\n\n/**\n * DEPLOYMENT\n *\n * Build for production:\n * ```bash\n * npm run build\n * ```\n *\n * Deploy `dist/` to:\n * - Vercel: npx vercel\n * - Netlify: npx netlify deploy\n * - Firebase Hosting: firebase deploy\n * - GitHub Pages: gh-pages package\n * - Any static host!\n *\n * ## Environment Variables\n * Set in hosting platform:\n * - VITE_SUPABASE_URL\n * - VITE_SUPABASE_ANON_KEY\n */\n\n/**\n * NAVIGATION PATTERNS\n *\n * Using Link component:\n * ```typescript\n * import { Link } from 'react-router-dom'\n *\n * <Link to=\"/dashboard\">Dashboard</Link>\n * ```\n *\n * Using useNavigate hook:\n * ```typescript\n * import { useNavigate } from 'react-router-dom'\n *\n * const navigate = useNavigate()\n * navigate('/dashboard')\n * ```\n *\n * Redirect on condition:\n * ```typescript\n * if (success) {\n *   return <Navigate to=\"/dashboard\" />\n * }\n * ```\n */\n\n/**\n * PERFORMANCE OPTIMIZATIONS\n *\n * 1. **Lazy Loading:**\n *    - Splits code into chunks\n *    - Loads pages on demand\n *    - Reduces initial bundle\n *\n * 2. **Supabase Caching:**\n *    - Enable client-side caching\n *    - Reduces database queries\n *    - Faster perceived performance\n *\n * 3. **Memoization:**\n *    - Use useMemo for expensive calculations\n *    - Use useCallback for stable functions\n *    - Prevent unnecessary re-renders\n *\n * 4. **Virtual Scrolling:**\n *    - For large lists (react-window)\n *    - Only render visible items\n *    - Smooth scrolling even with 1000s of items\n */\n\n/**\n * COMPARING WITH NEXT.JS\n *\n * | Feature | React+Vite+Supabase | Next.js+Supabase |\n * |---------|-------------------|------------------|\n * | `Routing` | React Router | File-based |\n * | `Rendering` | Client-only | SSR + CSR |\n * | `SEO` | `Poor` | `Excellent` |\n * | `Complexity` | `Low` | `Medium` |\n * | `Server` | `None` | `Node.js` |\n * | `Hosting` | `Static` | `Dynamic` |\n * | `Cost` | `Cheaper` | More expensive |\n * | Speed (Dev) | Faster (Vite) | Fast (Next.js) |\n *\n * Choose SPA when:\n * - Building internal tools\n * - SEO doesn't matter\n * - Want simplest architecture\n * - Learning React fundamentals\n */\n",
      "language": "typescript"
    },
    {
      "path": "src/components/AttachmentList.tsx",
      "content": "/**\n * REF: attachment-list-supabase-component\n *\n * # AttachmentList Component (Supabase)\n *\n * Displays list of file attachments for a todo.\n */\n\nimport { Attachment } from '../types'\nimport { formatFileSize } from '../lib/storage'\n\ninterface AttachmentListProps {\n  attachments: Attachment[]\n  onDelete?: (attachment: Attachment) => void\n  readOnly?: boolean\n}\n\nexport default function AttachmentList({\n  attachments,\n  onDelete,\n  readOnly = false,\n}: AttachmentListProps) {\n  const handleDelete = (attachment: Attachment) => {\n    if (!onDelete) return\n    if (confirm(`Delete ${attachment.fileName}?`)) {\n      onDelete(attachment)\n    }\n  }\n\n  const getFileIcon = (mimeType: string) => {\n    if (mimeType.startsWith('image/')) return 'üñºÔ∏è'\n    if (mimeType.startsWith('video/')) return 'üé•'\n    if (mimeType.startsWith('audio/')) return 'üéµ'\n    if (mimeType.includes('pdf')) return 'üìÑ'\n    if (mimeType.includes('word') || mimeType.includes('document')) return 'üìù'\n    if (mimeType.includes('sheet') || mimeType.includes('excel')) return 'üìä'\n    if (mimeType.includes('zip') || mimeType.includes('compressed')) return 'üóúÔ∏è'\n    return 'üìé'\n  }\n\n  if (!attachments || attachments.length === 0) {\n    return null\n  }\n\n  return (\n    <div className=\"mt-4\">\n      <h4 className=\"text-sm font-medium mb-2\">Attachments</h4>\n      <div className=\"space-y-2\">\n        {attachments.map((attachment, index) => (\n          <div\n            key={index}\n            className=\"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\"\n          >\n            <a\n              href={attachment.fileUrl}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"flex items-center gap-2 flex-1 hover:text-blue-600 transition\"\n            >\n              <span className=\"text-2xl\">\n                {getFileIcon(attachment.mimeType)}\n              </span>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium truncate\">\n                  {attachment.fileName}\n                </p>\n                <p className=\"text-xs text-gray-500\">\n                  {formatFileSize(attachment.fileSize)}\n                </p>\n              </div>\n            </a>\n\n            {!readOnly && onDelete && (\n              <button\n                onClick={() => handleDelete(attachment)}\n                className=\"ml-2 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:hover:bg-red-900 rounded transition\"\n              >\n                Delete\n              </button>\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n// CLOSE: attachment-list-supabase-component\n\n/**\n * REF: file-display-grid\n *\n * ## Attachment Grid Display\n *\n * ### File Type Detection\n * Uses MIME type to show appropriate emoji icon:\n * - image/* ‚Üí üñºÔ∏è (image icon)\n * - video/* ‚Üí üé• (video camera)\n * - audio/* ‚Üí üéµ (musical note)\n * - */pdf ‚Üí üìÑ (document)\n * - */word ‚Üí üìù (memo/document)\n * - */sheet ‚Üí üìä (bar chart)\n * - */zip ‚Üí üóúÔ∏è (compression)\n * - default ‚Üí üìé (paperclip)\n *\n * ### File Size Formatting\n * formatFileSize() converts bytes to readable:\n * - < 1KB: \"123 B\"\n * - < 1MB: \"4.5 KB\"\n * - < 1GB: \"12.3 MB\"\n * - >= 1GB: \"2.5 GB\"\n *\n * ### Download Links\n * - Href is public URL from Supabase Storage\n * - target=\"_blank\" opens in new tab\n * - rel=\"noopener noreferrer\" for security\n * - Direct download on click\n *\n * ### Delete Functionality\n * - Delete button shows only if not readOnly\n * - Confirmation dialog before deletion\n * - Calls onDelete callback with attachment\n * - Parent handles removal from Supabase\n *\n * CLOSE: file-display-grid\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/components/AttachmentUpload.tsx",
      "content": "/**\n * REF: attachment-upload-supabase-component\n *\n * # AttachmentUpload Component (Supabase)\n *\n * File upload component for todo attachments using Supabase Storage.\n */\n\nimport { useState, ChangeEvent } from 'react'\nimport { uploadTodoAttachment, validateAttachmentFile } from '../lib/storage'\nimport { Attachment } from '../types'\n\ninterface AttachmentUploadProps {\n  userId: string\n  todoId: string\n  onUploadComplete: (attachment: Attachment) => void\n}\n\nexport default function AttachmentUpload({\n  userId,\n  todoId,\n  onUploadComplete,\n}: AttachmentUploadProps) {\n  const [uploading, setUploading] = useState(false)\n  const [error, setError] = useState('')\n\n  const handleFileSelect = async (e: ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file) return\n\n    setError('')\n\n    if (!validateAttachmentFile(file)) {\n      setError('File must be less than 5MB')\n      return\n    }\n\n    setUploading(true)\n\n    try {\n      const attachment = await uploadTodoAttachment(userId, todoId, file)\n      onUploadComplete({\n        ...attachment,\n        uploadedAt: new Date().toISOString(),\n      })\n      e.target.value = ''\n    } catch (err: any) {\n      console.error('Upload error:', err)\n      setError(err.message || 'Failed to upload file')\n    } finally {\n      setUploading(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <div>\n        <label className=\"block text-sm font-medium mb-1\">\n          Attach File\n        </label>\n        <input\n          type=\"file\"\n          onChange={handleFileSelect}\n          disabled={uploading}\n          className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50\"\n        />\n        <p className=\"text-xs text-gray-500 mt-1\">\n          Max file size: 5MB\n        </p>\n      </div>\n\n      {uploading && (\n        <p className=\"text-sm text-blue-600\">\n          Uploading...\n        </p>\n      )}\n\n      {error && (\n        <p className=\"text-sm text-red-600\">\n          {error}\n        </p>\n      )}\n    </div>\n  )\n}\n// CLOSE: attachment-upload-supabase-component\n",
      "language": "typescript"
    },
    {
      "path": "src/components/Layout.tsx",
      "content": "/**\n * REF: Application Layout Shell\n *\n * Wrapper component providing consistent navigation header, main content area,\n * and footer across all pages. Handles auth-dependent navigation display.\n *\n * CLOSE: Wrap page components with Layout to get header, navigation, and footer.\n * Displays different nav options based on authentication state.\n *\n * LAYOUT STRUCTURE:\n * ```\n * <Layout>\n *   <header>                    // Top navigation bar\n *     Logo + Branding\n *     {user ? Authenticated Nav : Public Nav}\n *   </header>\n *   <main>                      // Page content area\n *     {children}                // Page component renders here\n *   </main>\n *   <footer>                    // Bottom credit/info\n *     Copyright and stack info\n *   </footer>\n * </Layout>\n * ```\n *\n * ### Props\n * | `Prop` | Type | Purpose |\n * |------|------|---------|\n * | `children` | `ReactNode` | Page component to render in main area |\n *\n * NAVIGATION STATES:\n * | `State` | `Links` | `Buttons` |\n * |-------|-------|---------|\n * | `Authenticated` | Dashboard, Feed, Messages, Settings | Sign Out |\n * | Not Authenticated | `Home` | Sign In, Sign Up |\n *\n * ## Features\n * - Responsive header with flexbox\n * - Mobile hamburger-friendly navigation (implicit with Tailwind)\n * - Logo links back to home\n * - Sign Out button triggers auth logout\n * - Sticky footer with project credits\n * - Shadow below header for visual separation\n * - Gray background on page content area\n *\n * SUPABASE AUTH INTEGRATION:\n * - Gets user from useAuth() hook\n * - Calls signOut() on button click\n * - After logout, navigates to home (/)\n * - Navigates to authenticated pages after login\n *\n * ## Styling\n * - Tailwind CSS utility classes\n * - Flexbox for responsive alignment\n * - Gap spacing between nav items\n * - Hover transitions on links\n * - min-h-screen ensures footer at bottom\n * - flex flex-col on root for sticky footer\n *\n * FILE REFERENCES:\n * - ../contexts/AuthContext.tsx - useAuth() hook\n * - ../pages/* - Pages wrapped with Layout\n *\n * USED IN:\n * - Dashboard page\n * - Feed page\n * - Messages page\n * - Settings page\n * - (Landing, SignIn, SignUp typically don't use Layout)\n */\n\nimport { ReactNode } from 'react'\nimport { Link, useNavigate } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\n\ninterface LayoutProps {\n  children: ReactNode\n}\n\n/**\n * REF: layout-component\n */\nexport default function Layout({ children }: LayoutProps) {\n  const { user, signOut } = useAuth()\n  const navigate = useNavigate()\n\n  const handleSignOut = async () => {\n    await signOut()\n    navigate('/')\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gray-50\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <Link to=\"/\" className=\"text-2xl font-bold text-purple-600\">\n              Todo App\n            </Link>\n\n            {user ? (\n              <nav className=\"flex items-center gap-6\">\n                <Link to=\"/dashboard\" className=\"hover:text-purple-600 transition\">\n                  Dashboard\n                </Link>\n                <Link to=\"/feed\" className=\"hover:text-purple-600 transition\">\n                  Feed\n                </Link>\n                <Link to=\"/messages\" className=\"hover:text-purple-600 transition\">\n                  Messages\n                </Link>\n                <Link to=\"/settings\" className=\"hover:text-purple-600 transition\">\n                  Settings\n                </Link>\n                <button\n                  onClick={handleSignOut}\n                  className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700\"\n                >\n                  Sign Out\n                </button>\n              </nav>\n            ) : (\n              <nav className=\"flex gap-4\">\n                <Link to=\"/signin\" className=\"px-4 py-2 text-purple-600\">\n                  Sign In\n                </Link>\n                <Link to=\"/signup\" className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700\">\n                  Sign Up\n                </Link>\n              </nav>\n            )}\n          </div>\n        </div>\n      </header>\n\n      <main className=\"flex-1\">\n        {children}\n      </main>\n\n      <footer className=\"bg-white border-t mt-auto\">\n        <div className=\"container mx-auto px-4 py-6 text-center text-gray-600 text-sm\">\n          <p>&copy; 2025 Todo App. Built with React, Vite, Supabase, and PostgreSQL.</p>\n        </div>\n      </footer>\n    </div>\n  )\n}\n// CLOSE: layout-component\n\n/**\n * SUPABASE IN LAYOUT\n *\n * Could add real-time notifications:\n *\n * ```tsx\n * const [unreadCount, setUnreadCount] = useState(0)\n *\n * useEffect(() => {\n *   if (!user) return\n *\n *   // Subscribe to unread messages\n *   const channel = supabase\n *     .channel('notifications')\n *     .on('postgres_changes', {\n *       event: 'INSERT',\n *       schema: 'public',\n *       table: 'messages',\n *       filter: `recipient_id=eq.${user.id}`\n *     }, () => {\n *       // Increment count\n *       setUnreadCount(prev => prev + 1)\n *     })\n *     .subscribe()\n *\n *   return () => supabase.removeChannel(channel)\n * }, [user])\n *\n * <Link to=\"/messages\">\n *   Messages {unreadCount > 0 && `(${unreadCount})`}\n * </Link>\n * ```\n */\n",
      "language": "typescript"
    },
    {
      "path": "src/components/LoadingSpinner.tsx",
      "content": "/**\n * REF: Loading Spinner Component\n *\n * Reusable animated spinner component for showing loading states.\n * Used while Supabase queries execute or components load.\n *\n * CLOSE: Import and use this component anywhere you need to show a loading indicator.\n * Accepts optional size and text props for customization.\n *\n * ### Props\n * | `Prop` | Type | Default | Purpose |\n * |------|------|---------|---------|\n * | `size` | `'sm'` | `'md'` | `'lg'` | `'md'` | Spinner diameter |\n * | `text` | `string` | `undefined` | Optional loading message below spinner |\n *\n * USAGE EXAMPLES:\n * ```tsx\n * // Default size (medium)\n * <LoadingSpinner />\n *\n * // With text\n * <LoadingSpinner text=\"Loading todos...\" />\n *\n * // Small size\n * <LoadingSpinner size=\"sm\" />\n *\n * // Large size with text\n * <LoadingSpinner size=\"lg\" text=\"Fetching messages...\" />\n * ```\n *\n * ## Styling\n * - CSS animation with spinning rotation\n * - Tailwind CSS for responsive sizing\n * - Flexbox centered layout\n * - Color: Purple-600 (brand color)\n * - Accessible with aria-label\n *\n * SIZE SPECIFICATIONS:\n * | `Size` | CSS Classes | `Usage` |\n * |------|-------------|-------|\n * | `sm` | w-4 h-4 border-2 | Inline loading indicators |\n * | `md` | w-8 h-8 border-4 | Standard loading screens |\n * | `lg` | w-12 h-12 border-4 | Full-page loading |\n *\n * ## Animation\n * - animate-spin class from Tailwind\n * - Continuous 1-second rotation\n * - Smooth, hardware-accelerated (uses transform)\n * - border-t-transparent creates spinning effect\n *\n * ## Accessibility\n * - role=\"status\" indicates loading to screen readers\n * - aria-label=\"Loading\" provides description\n * - No keyboard interaction needed\n *\n * USED IN:\n * - ProtectedRoute (auth loading)\n * - Dashboard (todo fetching)\n * - Settings (file upload)\n * - Messages page (conversation loading)\n */\n\ninterface LoadingSpinnerProps {\n  size?: 'sm' | 'md' | 'lg'\n  text?: string\n}\n\nexport default function LoadingSpinner({\n  size = 'md',\n  text,\n}: LoadingSpinnerProps) {\n  const sizeClasses = {\n    sm: 'w-4 h-4 border-2',\n    md: 'w-8 h-8 border-4',\n    lg: 'w-12 h-12 border-4',\n  }\n\n  /** REF: component-return\n   */\n  return (\n    <div className=\"flex flex-col items-center justify-center gap-3\">\n      <div\n        className={`\n  // CLOSE: component-return\n          ${sizeClasses[size]}\n          border-purple-600\n          border-t-transparent\n          rounded-full\n          animate-spin\n        `}\n        role=\"status\"\n        aria-label=\"Loading\"\n      />\n\n      {text && <p className=\"text-sm text-gray-600\">{text}</p>}\n    </div>\n  )\n}\n\n/**\n * REF: spinner-animation\n *\n * ## CSS Animation Technique\n *\n * Uses Tailwind animate-spin for hardware acceleration:\n * - Rotates element continuously\n * - 1 second per full rotation\n * - Linear timing (no easing)\n * - GPU-accelerated transform\n * - No JavaScript during animation\n *\n * ### Border Trick\n * - Full border: border-blue-600\n * - Top transparent: border-t-transparent\n * - Creates \"spinning\" illusion\n * - Simple and performant\n *\n * ### Alternative Approaches\n * 1. SVG spinner (more control)\n * 2. Lottie animation (complex)\n * 3. GIF image (larger file)\n * 4. Canvas animation (complex)\n *\n * **Best for:** Loading spinners, simple animations\n *\n * CLOSE: spinner-animation\n */\n",
      "language": "typescript"
    },
    {
      "path": "src/components/ProtectedRoute.tsx",
      "content": "/**\n * REF: Protected Route Guard Component\n *\n * Wrapper component that ensures routes are only accessible to authenticated users.\n * Checks Supabase session and redirects to signin if user is not logged in.\n *\n * CLOSE: Use this component to wrap any Route elements that should require authentication.\n * If user is not authenticated, they are redirected to /signin page.\n *\n * ### Usage\n * ```tsx\n * <Route\n *   path=\"/dashboard\"\n *   element={\n *     <ProtectedRoute>\n *       <Dashboard />\n *     </ProtectedRoute>\n *   }\n * />\n * ```\n *\n * GUARD FLOW:\n * 1. User navigates to protected route\n * 2. ProtectedRoute checks useAuth() hook\n * 3. If loading, show loading spinner\n * 4. If not authenticated, redirect to /signin\n * 5. If authenticated, render children component\n *\n * ## Authentication State\n * | `State` | `Behavior` |\n * |-------|----------|\n * | `Loading` | Show LoadingSpinner while checking session |\n * | Not authenticated | Redirect to /signin with replace=true |\n * | `Authenticated` | Render children as normal |\n *\n * TECH DETAILS:\n * - Uses React Router v6 Navigate component\n * - replace=true prevents back button issues\n * - Calls useAuth() hook from AuthContext\n * - Checks both user and loading states\n *\n * SECURITY NOTES:\n * - This is UX protection (good for user experience)\n * - Real security is at database level (RLS policies)\n * - Advanced users can bypass client-side checks\n * - RLS ensures database blocks unauthorized access\n * - Example: User bypasses route guard but tries Supabase query:\n *   - Their JWT token is checked\n *   - RLS policies validate ownership\n *   - Query fails with \"policy violation\" error\n *\n * FILE REFERENCES:\n * - ../contexts/AuthContext.tsx - useAuth() hook\n * - ../App.tsx - Routes using ProtectedRoute\n */\n\nimport { ReactNode } from 'react'\nimport { Navigate } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\n\ninterface ProtectedRouteProps {\n  children: ReactNode\n}\n\nexport default function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const { user, loading } = useAuth()\n\n  /** REF: conditional-block\n   */\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center\">\n        <div className=\"text-xl\">Loading...</div>\n      </div>\n    )\n  }\n\n  if (!user) {\n    return <Navigate to=\"/signin\" replace />\n  }\n\n  return <>{children}</>\n}\n\n/**\n * SUPABASE SESSION IN SPA\n *\n * Session stored in localStorage:\n * - Survives page reload\n * - Auto-refreshes before expiry\n * - Syncs across tabs\n *\n * useAuth() provides:\n * - user: Current user object (or null)\n * - loading: Auth check in progress\n * - session: Full session with tokens\n */\n\n/**\n * RLS ENFORCEMENT\n *\n * Even if user bypasses this route guard:\n * - PostgreSQL RLS blocks unauthorized queries\n * - Database returns empty results\n * - Or returns \"policy violation\" error\n *\n * Client protection is UX\n * Database protection is security!\n */\n\n/**\n * REF: auth-state-machine\n *\n * ## Authentication State Machine\n *\n * ### Three States\n * | State | Condition | Action |\n * |-------|-----------|--------|\n * | Loading | `loading === true` | Show spinner |\n * | Unauthenticated | `user === null && !loading` | Redirect to /signin |\n * | Authenticated | `user !== null && !loading` | Render children |\n *\n * ### Why Not Two States?\n * If we only checked `!user`:\n * - First render: user=null, redirect before check\n * - Flashes signin page briefly\n * - Poor UX, confusing\n *\n * **Solution:** Check loading flag\n * - Skip redirect while loading\n * - Wait for auth check to complete\n * - Show spinner instead\n * - Smooth transition to protected content\n *\n * ### Loading Timeline\n * 1. App mounts\n * 2. AuthContext calls getSession()\n * 3. loading = true\n * 4. While loading, ProtectedRoute shows spinner\n * 5. Token validated, user set\n * 6. loading = false\n * 7. ProtectedRoute renders children\n *\n * ### Token Refresh\n * - getSession() checks expiration\n * - Expired? Refresh token automatically\n * - Supabase client handles this\n * - User never sees \"session expired\" error\n * - Refresh happens transparent to user\n *\n * CLOSE: auth-state-machine\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/components/TodoForm.tsx",
      "content": "/**\n * REF: Todo Creation Form Component\n *\n * Form component for creating new todos with title, description, public visibility, and tags.\n * Handles validation, error states, and insertion into Supabase PostgreSQL.\n *\n * CLOSE: Import and use in parent components (Dashboard, etc.) to allow users to create todos.\n * Passes userId prop and optional onSuccess callback.\n *\n * ### Props\n * | `Prop` | Type | `Required` | Purpose |\n * |------|------|----------|---------|\n * | `userId` | `string` | `Yes` | Supabase user ID for RLS enforcement |\n * | `onSuccess` | `function` | `No` | Callback after successful creation |\n *\n * FORM FIELDS:\n * | `Field` | Type | `Required` | Max Length | Purpose |\n * |-------|------|----------|-----------|---------|\n * | `title` | `text` | `Yes` | `-` | Main task text |\n * | `description` | `textarea` | `No` | `-` | Optional details |\n * | `isPublic` | `checkbox` | `No` | `-` | Make todo visible to others |\n * | `tags` | `array` | `No` | `10` | Searchable/filterable tags |\n *\n * STATE MANAGEMENT:\n * ```typescript\n * title: string              // Form input state\n * description: string        // Form input state\n * isPublic: boolean          // Checkbox state\n * tags: string[]             // Array of tag strings\n * tagInput: string           // Input field for new tag\n * loading: boolean           // Submission in progress\n * error: string              // Error message if submission fails\n * ```\n *\n * SUBMISSION FLOW:\n * 1. User fills form and clicks \"Create Todo\"\n * 2. handleSubmit validates title (required)\n * 3. Sets loading=true, clears error\n * 4. Calls supabase.from('todos').insert({...})\n * 5. RLS policy validates user_id = auth.uid()\n * 6. If success, clears form and calls onSuccess callback\n * 7. If error, displays message and keeps form data\n *\n * TAG MANAGEMENT:\n * - Add tag: User types tag name and clicks \"Add\" or presses Enter\n * - Validation: No duplicates, max 10 tags, trim whitespace\n * - Remove tag: Click √ó button on tag chip\n * - Display: Hashtag-prefixed blue chips\n *\n * ## Error Handling\n * | `Scenario` | Error Message |\n * |----------|---------------|\n * | Empty title | \"Title is required\" |\n * | RLS violation | \"new row violates row-level security policy\" |\n * | Database error | Server error message |\n *\n * TECHNICAL DETAILS:\n * - Uses Supabase JS client for INSERT operation\n * - .select().single() returns inserted row\n * - Null coalescing for optional fields\n * - RLS ensures user_id matches JWT token owner\n * - Timestamps auto-generated by PostgreSQL triggers\n *\n * SUPABASE QUERY PATTERN:\n * ```typescript\n * const { data, error } = await supabase\n *   .from('todos')\n *   .insert({\n *     user_id: userId,\n *     title: title.trim(),\n *     description: description.trim() || null,\n *     is_public: isPublic,\n *     tags: tags.length > 0 ? tags : null,\n *     completed: false\n *   })\n *   .select()\n *   .single()\n * ```\n */\n\nimport { useState, FormEvent } from 'react'\nimport { supabase } from '../lib/supabase'\n\ninterface TodoFormProps {\n  userId: string\n  onSuccess?: () => void\n}\n\nexport default function TodoForm({ userId, onSuccess }: TodoFormProps) {\n  const [title, setTitle] = useState('')\n  const [description, setDescription] = useState('')\n  const [isPublic, setIsPublic] = useState(false)\n  const [tags, setTags] = useState<string[]>([])\n  const [tagInput, setTagInput] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n\n  /**\n   * SUBMIT HANDLER\n   *\n   * Inserts into PostgreSQL via Supabase client\n   *\n   * RLS ENFORCEMENT:\n   * - Policy checks user_id = auth.uid()\n   * - Even if we try to set different user_id, database blocks it\n   * - Security at the source!\n   */\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault()\n    setError('')\n\n    if (!title.trim()) {\n      setError('Title is required')\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      const { data, error: insertError } = await supabase\n        .from('todos')\n        .insert({\n          user_id: userId,\n          title: title.trim(),\n          description: description.trim() || null,\n          is_public: isPublic,\n          tags: tags.length > 0 ? tags : null,\n          completed: false,\n        })\n        .select()\n        .single()\n\n      if (insertError) throw insertError\n\n      // Clear form\n      setTitle('')\n      setDescription('')\n      setIsPublic(false)\n      setTags([])\n\n      onSuccess?.()\n    } catch (err: any) {\n      console.error('Error:', err)\n      setError(err.message || 'Failed to create todo')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleAddTag = () => {\n    const tag = tagInput.trim().toLowerCase()\n    if (tag && !tags.includes(tag) && tags.length < 10) {\n      setTags([...tags, tag])\n      setTagInput('')\n    }\n  }\n\n  const handleRemoveTag = (tag: string) => {\n    setTags(tags.filter(t => t !== tag))\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {error && (\n        <div className=\"bg-red-100 text-red-700 px-4 py-3 rounded\">\n          {error}\n        </div>\n      )}\n\n      <div>\n        <label htmlFor=\"title\" className=\"block text-sm font-medium mb-2\">\n          Title <span className=\"text-red-500\">*</span>\n        </label>\n        <input\n          id=\"title\"\n          type=\"text\"\n          value={title}\n          onChange={(e) => setTitle(e.target.value)}\n          required\n          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n          placeholder=\"What needs to be done?\"\n        />\n      </div>\n\n      {/** REF: description-textarea\n       * Multi-line description textarea field.\n       * Provides 3 rows for detailed todo descriptions.\n       */}\n      <div>\n        <label htmlFor=\"description\" className=\"block text-sm font-medium mb-2\">\n          Description\n        </label>\n        <textarea\n          id=\"description\"\n          value={description}\n          onChange={(e) => setDescription(e.target.value)}\n          rows={3}\n          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n          placeholder=\"Add details...\"\n        />\n      </div>\n      {/* CLOSE: description-textarea */}\n\n      {/** REF: public-checkbox\n       * Checkbox to mark todo as public or private.\n       * Toggles isPublic state when changed.\n       */}\n      <div className=\"flex items-center gap-2\">\n        <input\n          id=\"isPublic\"\n          type=\"checkbox\"\n          checked={isPublic}\n          onChange={(e) => setIsPublic(e.target.checked)}\n          className=\"w-4 h-4\"\n        />\n        <label htmlFor=\"isPublic\" className=\"text-sm cursor-pointer\">\n          Make public\n        </label>\n      </div>\n      {/* CLOSE: public-checkbox */}\n\n      {/** REF: tags-section\n       * Tags input section allowing users to add and manage tags.\n       * Features tag input with Enter key support and add button.\n       */}\n      {/* Tags */}\n      <div>\n        <label className=\"block text-sm font-medium mb-2\">Tags</label>\n        <div className=\"flex gap-2 mb-2\">\n          <input\n            type=\"text\"\n            value={tagInput}\n            onChange={(e) => setTagInput(e.target.value)}\n            onKeyDown={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddTag())}\n            className=\"flex-1 px-4 py-2 border rounded-lg\"\n            placeholder=\"Add tag...\"\n          />\n          <button\n            type=\"button\"\n            onClick={handleAddTag}\n            className=\"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300\"\n          >\n            Add\n          </button>\n        </div>\n\n        {tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-2\">\n            {tags.map(tag => (\n              <span key={tag} className=\"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 rounded-full text-sm\">\n                #{tag}\n                <button type=\"button\" onClick={() => handleRemoveTag(tag)}>√ó</button>\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n      {/* CLOSE: tags-section */}\n\n            <button\n        type=\"submit\"\n        disabled={loading}\n        className=\"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400\"\n      >\n        {loading ? 'Creating...' : 'Create Todo'}\n      </button>\n    </form>\n  )\n}\n\n/**\n * POSTGRESQL ARRAY ADVANTAGES\n *\n * Query with array operators:\n * ```typescript\n * // Contains specific tag\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *   .contains('tags', ['urgent'])\n *\n * // Overlaps with tags\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *   .overlaps('tags', ['work', 'urgent'])\n * ```\n *\n * Create GIN index for fast searches:\n * ```sql\n * CREATE INDEX idx_todos_tags ON todos USING GIN(tags);\n * ```\n */\n\n/**\n * TYPE GENERATION\n *\n * Generate types from database:\n * ```bash\n * npx supabase gen types typescript --project-id YOUR_ID > src/lib/database.types.ts\n * ```\n *\n * Then import:\n * ```typescript\n * import type { Database } from '../lib/database.types'\n *\n * type Todo = Database['public']['Tables']['todos']['Row']\n * type NewTodo = Database['public']['Tables']['todos']['Insert']\n * ```\n *\n * Full autocomplete for all database operations!\n */\n\n/**\n * REF: form-submission-handler\n *\n * ## Form Submission & Validation\n *\n * ### Client-Side Validation\n * - Title required and non-empty (trimmed)\n * - Max length enforced by HTML maxLength attribute\n * - Tags limited to 10 maximum\n * - Description optional but trimmed\n *\n * ### Supabase Insert Operation\n * ```typescript\n * const { data, error } = await supabase\n *   .from('todos')\n *   .insert({\n *     user_id,           // From auth\n *     title,             // Required\n *     description,       // Optional\n *     completed: false,  // Always new\n *     is_public,         // From checkbox\n *     tags,              // From array\n *     created_at: new Date().toISOString(),  // Server time\n *     updated_at: new Date().toISOString()\n *   })\n *   .select()           // Return inserted row\n *   .single()           // Expect exactly one\n * ```\n *\n * ### RLS Security Check\n * Database enforces: `auth.uid() = user_id`\n * - User cannot set user_id to someone else's ID\n * - Database will reject if doesn't match\n * - No way to bypass from client\n *\n * ### Error Handling\n * - RLS violations show as 403 Forbidden\n * - Network errors show timeout\n * - Validation errors show message\n * - All displayed to user in error state\n *\n * ### Success Flow\n * 1. Insert succeeds\n * 2. Clear form fields\n * 3. Call onSuccess callback\n * 4. Parent refetches todos list\n * 5. New todo appears in UI\n *\n * CLOSE: form-submission-handler\n */\n\n/**\n * REF: controlled-input-pattern\n *\n * ## React Controlled Components\n *\n * ### What Are Controlled Components?\n * Input values stored in React state, not DOM\n * - User types ‚Üí onChange fires ‚Üí setState ‚Üí input updates\n * - Single source of truth: state object\n * - Enables real-time validation\n * - Easy to reset or modify values\n *\n * ### Uncontrolled Alternative\n * ```typescript\n * // Uncontrolled - value stored in DOM\n * <input defaultValue=\"initial\" />\n * const value = inputRef.current.value  // Accessed on submit\n * ```\n *\n * ### Controlled Pattern (This File)\n * ```typescript\n * // State holds value\n * const [title, setTitle] = useState('')\n *\n * // Input always reflects state\n * <input\n *   value={title}\n *   onChange={(e) => setTitle(e.target.value)}\n * />\n * ```\n *\n * ### Why Controlled?\n * - Validation as user types\n * - Reset button clears form\n * - Disable during submission\n * - Format/transform input\n * - Prevents invalid states\n *\n * CLOSE: controlled-input-pattern\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/components/TodoList.tsx",
      "content": "/**\n * REF: TodoList Display Component\n *\n * Presentational component that renders a list of todos grouped by completion status.\n * Receives todos array and callback handlers from parent component.\n *\n * CLOSE: This is a stateless, reusable component that displays todos passed via props.\n * It does not fetch data or manage state - all data management is in parent (Dashboard).\n *\n * ## Component Structure\n * | `Section` | Purpose |\n * |---------|---------|\n * | Active Todos | Incomplete tasks grouped at top |\n * | Completed Todos | Finished tasks grouped below, muted styling |\n * | Empty State | Message when no todos exist |\n *\n * ### Props\n * | `Prop` | Type | Purpose |\n * |------|------|---------|\n * | `todos` | `Todo[]` | Array of todo objects to display |\n * | `onToggle` | `function` | Callback when checkbox clicked |\n * | `onDelete` | `function` | Callback when delete button clicked |\n *\n * TODO TYPE INTERFACE:\n * ```typescript\n * interface Todo {\n *   id: string              // PostgreSQL UUID\n *   user_id: string         // Owner user ID\n *   title: string           // Main task text\n *   description: string | null  // Optional details\n *   completed: boolean      // Completion status\n *   is_public: boolean      // Visibility flag\n *   tags: string[] | null   // Array of tag strings\n *   created_at: string      // ISO timestamp\n *   updated_at: string      // ISO timestamp\n * }\n * ```\n *\n * STYLING APPROACH:\n * - Tailwind CSS utility classes\n * - Responsive grid and flexbox layouts\n * - Conditional classes for completed items (strikethrough, grayed out)\n * - Shadow and rounded borders for visual hierarchy\n *\n * NESTED COMPONENTS:\n * - TodoItem: Renders individual todo with checkbox, title, description, tags, delete button\n *\n * ## Features\n * - Separates active vs completed todos\n * - Shows counts in section headers\n * - Renders tags with hashtag prefix\n * - Delete button with trash emoji\n * - Responsive to all screen sizes\n * - Empty state when no todos\n *\n * PARENT RESPONSIBILITIES:\n * - Fetch todos from Supabase\n * - Handle toggle/delete operations\n * - Pass handlers that perform mutations\n */\n\ninterface Todo {\n  id: string\n  user_id: string\n  title: string\n  description: string | null\n  completed: boolean\n  is_public: boolean\n  tags: string[] | null\n  created_at: string\n  updated_at: string\n}\n\ninterface TodoListProps {\n  todos: Todo[]\n  onToggle: (todoId: string, completed: boolean) => void\n  onDelete: (todoId: string) => void\n}\n\nexport default function TodoList({ todos, onToggle, onDelete }: TodoListProps) {\n  const activeTodos = todos.filter(t => !t.completed)\n  const completedTodos = todos.filter(t => t.completed)\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Active */}\n      {activeTodos.length > 0 && (\n        <div>\n          <h3 className=\"text-lg font-semibold mb-3\">\n            Active ({activeTodos.length})\n          </h3>\n          {/** REF: active-todos-list\n           * Maps through active todos and renders TodoItem for each.\n           * Displays todo items with full interaction capabilities.\n           */}\n          <div className=\"space-y-2\">\n            {activeTodos.map(todo => (\n              <TodoItem\n                key={todo.id}\n                todo={todo}\n                onToggle={onToggle}\n                onDelete={onDelete}\n              />\n            ))}\n          </div>\n          {/* CLOSE: active-todos-list */}\n        </div>\n      )}\n\n            {/* Completed */}\n      {completedTodos.length > 0 && (\n        <div>\n          <h3 className=\"text-lg font-semibold mb-3 text-gray-500\">\n            Completed ({completedTodos.length})\n          </h3>\n          {/** REF: completed-todos-list\n           * Maps through completed todos and renders TodoItem for each.\n           * Displays with reduced opacity to distinguish from active items.\n           */}\n          <div className=\"space-y-2 opacity-75\">\n            {completedTodos.map(todo => (\n              <TodoItem\n                key={todo.id}\n                todo={todo}\n                onToggle={onToggle}\n                onDelete={onDelete}\n              />\n            ))}\n          </div>\n          {/* CLOSE: completed-todos-list */}\n        </div>\n      )}\n\n      {todos.length === 0 && (\n        <p className=\"text-center text-gray-500 py-8\">\n          No todos yet. Create one above!\n        </p>\n      )}\n    </div>\n  )\n}\n\n/**\n * TODO ITEM INLINE\n */\n/** REF: todo-item-component\n * Individual todo item component with checkbox and delete button.\n * Displays todo details and handles completion toggle.\n */\nfunction TodoItem({ todo, onToggle, onDelete }: {\n  todo: Todo\n  onToggle: (id: string, completed: boolean) => void\n  onDelete: (id: string) => void\n}) {\n  return (\n    <div className=\"p-4 bg-white rounded-lg shadow flex items-start gap-4\">\n      <input\n        type=\"checkbox\"\n        checked={todo.completed}\n        onChange={() => onToggle(todo.id, todo.completed)}\n        className=\"mt-1 w-5 h-5 cursor-pointer\"\n      />\n\n      <div className=\"flex-1\">\n        <h4 className={`font-medium ${todo.completed ? 'line-through text-gray-500' : ''}`}>\n          {todo.title}\n        </h4>\n        {todo.description && (\n          <p className={`text-sm text-gray-600 mt-1 ${todo.completed ? 'line-through' : ''}`}>\n            {todo.description}\n          </p>\n        )}\n        {todo.tags && todo.tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-2 mt-2\">\n            {todo.tags.map(tag => (\n              <span key={tag} className=\"px-2 py-1 bg-gray-100 text-xs rounded-full\">\n                #{tag}\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <button\n        onClick={() => onDelete(todo.id)}\n        className=\"p-2 text-red-600 hover:bg-red-50 rounded\"\n      >\n        üóëÔ∏è\n      </button>\n    </div>\n  )\n  // CLOSE: todo-item-component\n}\n\n/**\n * POSTGRESQL QUERIES FROM SPA\n *\n * Parent component queries with Supabase:\n *\n * ```typescript\n * import { supabase } from '../lib/supabase'\n *\n * const { data: todos, error } = await supabase\n *   .from('todos')\n *   .select('*')\n *   .eq('user_id', user.id)\n *   .order('created_at', { ascending: false })\n *\n * // RLS automatically enforces security\n * // User only gets their own todos\n * ```\n *\n * Full SQL power from the browser!\n */\n\n/**\n * TYPE GENERATION\n *\n * For perfect type safety:\n *\n * ```bash\n * npx supabase gen types typescript --project-id YOUR_ID > src/lib/database.types.ts\n * ```\n *\n * Then:\n * ```typescript\n * import type { Database } from '../lib/database.types'\n *\n * type Todo = Database['public']['Tables']['todos']['Row']\n * ```\n *\n * Autocomplete for all database operations!\n */\n\n/**\n * REF: todo-item-subcomponent\n *\n * ## TodoItem Sub-component\n *\n * Renders individual todo with:\n * - Checkbox for completion toggle\n * - Title and description\n * - Tags display\n * - Attachment list\n * - Delete button\n * - Toggle completion status\n *\n * ### Props\n * - todo: Todo object with all data\n * - onToggle: Callback to mark complete/incomplete\n * - onDelete: Callback to remove todo\n *\n * ### Visual States\n * - Active: Normal styling\n * - Completed: Strikethrough, reduced opacity\n * - With attachments: Extra space below for attachment list\n *\n * ### Interactions\n * - Click checkbox: Toggle completed status\n * - Click √ó button: Delete todo (with confirmation)\n * - Click attachment: Download file\n *\n * CLOSE: todo-item-subcomponent\n */\n\n/**\n * REF: component-composition\n *\n * ## Inline vs Separate Component Pattern\n *\n * TodoItem is defined inline within TodoList.\n *\n * ### When to Inline (Like TodoItem)\n * - Single-use component (only in TodoList)\n * - Closely related to parent\n * - Shared parent state\n * - Simple presentation logic\n * - Easier to understand context\n *\n * ### When to Separate (Like TodoList)\n * - Reusable in multiple places\n * - Independent state management\n * - Testable in isolation\n * - Large number of props\n * - Part of design system\n *\n * **Decision Rule:**\n * - Reused 2+ times? ‚Üí Separate file\n * - Used in 1 file? ‚Üí Can inline\n * - Complex logic? ‚Üí Always separate\n * - Simple display? ‚Üí Can inline\n *\n * CLOSE: component-composition\n */\n",
      "language": "typescript"
    },
    {
      "path": "src/contexts/AuthContext.tsx",
      "content": "/**\n * REF: Authentication Context and Provider\n *\n * Global authentication state management using React Context and Supabase Auth.\n * Manages user sessions, JWT tokens, and provides auth methods to entire app.\n *\n * CLOSE: Wrap your app with AuthProvider to enable authentication throughout.\n * Use useAuth() hook in components to access user, session, and auth methods.\n *\n * PROVIDER HIERARCHY:\n * ```\n * AuthProvider\n *   ‚îú‚îÄ initializes auth state\n *   ‚îú‚îÄ listens for auth changes\n *   ‚îú‚îÄ manages tokens in localStorage\n *   ‚îî‚îÄ provides useAuth() hook to descendants\n * ```\n *\n * ## Context Value Provided\n * | `Property` | Type | Purpose |\n * |----------|------|---------|\n * | `user` | User \\| `null` | Current authenticated user object |\n * | `session` | Session \\| `null` | JWT tokens and metadata |\n * | `loading` | `boolean` | Auth check in progress |\n * | `signUp` | `function` | Create new user account |\n * | `signIn` | `function` | Authenticate with email/password |\n * | `signOut` | `function` | Logout current user |\n *\n * ## Authentication Flow\n * | `Action` | `Flow` |\n * |--------|------|\n * | App loads | getSession() checks localStorage for existing session |\n * | Session found | Validates token expiry, refreshes if needed |\n * | Session invalid | User is null, user sees login page |\n * | User signs in | signInWithPassword() returns JWT tokens |\n * | Tokens stored | localStorage automatically (via Supabase config) |\n * | Auth event fires | onAuthStateChange listener updates state |\n * | Components update | useAuth() hook re-renders with new user |\n * | User signs out | signOut() clears localStorage and state |\n *\n * ## Tech Stack\n * | `Component` | Purpose |\n * |-----------|---------|\n * | Supabase Auth | JWT-based authentication |\n * | `localStorage` | Persist session across page reloads |\n * | React Context | Provide auth state globally |\n * | useContext hook | Access auth state in components |\n * | JWT tokens | Signed credentials (exp, aud, sub, etc) |\n *\n * KEY SUPABASE AUTH EVENTS:\n * | `Event` | `Triggers` |\n * |-------|----------|\n * | `SIGNED_IN` | User successfully authenticated |\n * | `SIGNED_OUT` | User logged out or session expired |\n * | `TOKEN_REFRESHED` | JWT refreshed before expiry |\n * | `USER_UPDATED` | Profile or metadata changed |\n * | `PASSWORD_RECOVERY` | Password reset initiated |\n *\n * SESSION PERSISTENCE:\n * - Supabase client configured with localStorage storage\n * - autoRefreshToken: true keeps sessions alive\n * - persistSession: true restores on page reload\n * - Tokens auto-refresh 60 seconds before expiry\n * - Syncs across browser tabs\n *\n * USER PROFILE CREATION:\n * - When SIGNED_IN event fires, upsert to user_profiles table\n * - Stores display_name from user_metadata\n * - Also initializes user_settings with defaults\n * - Runs on every signin for safety (upsert is idempotent)\n *\n * METADATA USAGE:\n * - signUp accepts displayName in metadata option\n * - Stored in auth.users.raw_user_meta_data\n * - Accessible via user.user_metadata\n * - Useful for display names, preferences, roles\n *\n * HOOKS AND PATTERNS:\n * ```typescript\n * // Check if user is authenticated\n * const { user } = useAuth()\n * if (user) { /* show protected content */ }\n *\n * // Get current session (JWT tokens)\n * const { session } = useAuth()\n * const jwt = session?.access_token\n *\n * // Check if auth is still loading\n * const { loading } = useAuth()\n * if (loading) return <LoadingSpinner />\n *\n * // Sign up new user\n * const { signUp } = useAuth()\n * await signUp('user@example.com', 'password123', { displayName: 'John' })\n *\n * // Sign in existing user\n * const { signIn } = useAuth()\n * await signIn('user@example.com', 'password123')\n *\n * // Sign out\n * const { signOut } = useAuth()\n * await signOut()\n * ```\n *\n * ## Error Handling\n * | `Error` | `Cause` | `Handling` |\n * |-------|-------|----------|\n * | \"Invalid login credentials\" | Wrong email/password | Show form error |\n * | \"User already registered\" | Email exists | Suggest signin |\n * | \"Email not confirmed\" | Account not verified | Check email |\n * | \"Too many requests\" | Rate limited | Retry after delay |\n * | \"Password too short\" | < 6 characters | Update password rules |\n */\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react'\nimport type { User, Session } from '@supabase/supabase-js'\nimport { supabase } from '../lib/supabase'\n\ninterface AuthContextType {\n  user: User | null\n  session: Session | null\n  loading: boolean\n  signUp: (email: string, password: string, metadata?: { displayName?: string }) => Promise<void>\n  signIn: (email: string, password: string) => Promise<void>\n  signOut: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\n/**\n * AUTH PROVIDER\n *\n * Manages Supabase authentication state for the entire app\n *\n * SUPABASE SESSION MANAGEMENT:\n * - Session stored in localStorage automatically\n * - Tokens refreshed before expiry\n * - Works offline (cached session)\n * - Syncs across tabs\n */\n  /** REF: code-block\n   */\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [session, setSession] = useState<Session | null>(null)\n  const [loading, setLoading] = useState(true)\n  // CLOSE: code-block\n\n  /**\n   * AUTH STATE LISTENER\n   *\n   * Subscribe to Supabase auth changes\n   *\n   * ## Events\n   * - SIGNED_IN: User successfully authenticated\n   * - SIGNED_OUT: User logged out\n   * - TOKEN_REFRESHED: Session renewed\n   * - USER_UPDATED: Profile changed\n   * - PASSWORD_RECOVERY: Reset password flow\n   *\n   * INITIAL SESSION:\n   * - getSession() retrieves from localStorage\n   * - Validates token not expired\n   * - Refreshes if needed\n   * - Sets initial state\n   */\n  useEffect(() => {\n    // Get initial session from localStorage\n  /** REF: code-block\n   */\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setSession(session)\n      setUser(session?.user ?? null)\n      setLoading(false)\n  // CLOSE: code-block\n    })\n\n    // Listen for auth changes\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange(async (event, session) => {\n      console.log('Auth event:', event)\n      setSession(session)\n      setUser(session?.user ?? null)\n\n      /**\n       * CREATE USER PROFILE ON SIGNUP\n       *\n       * When user signs up, create profile in database\n       *\n       * ## Alternative\n       * Use database trigger (see Next.js + Supabase project)\n       * Trigger is more reliable (atomic with signup)\n       */\n      if (event === 'SIGNED_IN' && session?.user) {\n        const { error } = await supabase\n          .from('user_profiles')\n          .upsert({\n            user_id: session.user.id,\n            display_name: session.user.user_metadata?.displayName || '',\n            updated_at: new Date().toISOString(),\n          })\n\n        if (error) console.error('Error creating profile:', error)\n\n        // Create default settings\n        await supabase\n          .from('user_settings')\n          .upsert({\n            user_id: session.user.id,\n            updated_at: new Date().toISOString(),\n          })\n      }\n    })\n\n    return () => subscription.unsubscribe()\n  }, [])\n\n  /**\n   * SIGN UP\n   *\n   * Create new Supabase user\n   *\n   * @param email - User's email\n   * @param password - User's password (min 6 chars)\n   * @param metadata - Optional user metadata\n   *\n   * METADATA:\n   * - Stored in auth.users.raw_user_meta_data\n   * - Accessible via user.user_metadata\n   * - Useful for display name, preferences, etc.\n   */\n  const signUp = async (\n    email: string,\n    password: string,\n    metadata?: { displayName?: string }\n  ) => {\n    const { data, error } = await supabase.auth.signUp({\n      email,\n      password,\n      options: {\n        data: metadata,\n      },\n    })\n\n    if (error) throw error\n\n    // Check if email confirmation required\n    if (data.user && !data.session) {\n      throw new Error('Please check your email to confirm your account')\n    }\n  }\n\n  /**\n   * SIGN IN\n   *\n   * Authenticate existing user\n   *\n   * SUPABASE AUTH:\n   * - Validates email/password\n   * - Returns JWT tokens\n   * - Stores in localStorage\n   * - onAuthStateChange fires\n   */\n  const signIn = async (email: string, password: string) => {\n    const { error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    })\n\n    if (error) throw error\n  }\n\n  /**\n   * SIGN OUT\n   *\n   * Log out current user\n   *\n   * ## Cleanup\n   * - Clears localStorage\n   * - Invalidates session\n   * - onAuthStateChange fires with null\n   * - Context updates, UI re-renders\n   */\n  /** REF: state-variables\n   */\n  const signOut = async () => {\n    const { error } = await supabase.auth.signOut()\n    if (error) throw error\n  // CLOSE: state-variables\n  }\n\n  const value = {\n    user,\n    session,\n    loading,\n    signUp,\n    signIn,\n    signOut,\n  }\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\n}\n\n/**\n * USE AUTH HOOK\n */\n  /** REF: code-block\n   */\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n  // CLOSE: code-block\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n\n/**\n * SUPABASE AUTH SECURITY\n *\n * Built-in features:\n * - ‚úÖ Bcrypt password hashing\n * - ‚úÖ JWT token authentication\n * - ‚úÖ Automatic token refresh\n * - ‚úÖ Rate limiting\n * - ‚úÖ Email verification (optional)\n * - ‚úÖ MFA support (optional)\n *\n * You get enterprise-grade auth for free!\n */\n\n/**\n * SESSION PERSISTENCE\n *\n * Supabase automatically:\n * - Stores session in localStorage\n * - Restores on page reload\n * - Refreshes before expiry\n * - Syncs across tabs\n *\n * Configure persistence:\n * ```typescript\n * createClient(url, key, {\n *   auth: {\n *     storage: window.localStorage, // or sessionStorage\n *     autoRefreshToken: true,\n *     persistSession: true,\n *   }\n * })\n * ```\n */\n\n/**\n * SOCIAL AUTH\n *\n * Add OAuth providers:\n *\n * ```typescript\n * const { error } = await supabase.auth.signInWithOAuth({\n *   provider: 'google',\n *   options: {\n *     redirectTo: `${window.location.origin}/auth/callback`\n *   }\n * })\n * ```\n *\n * Supported providers:\n * - Google, GitHub, GitLab, Bitbucket\n * - Facebook, Twitter, Discord\n * - Apple, Azure, Slack\n * - And more!\n */\n\n/**\n * MAGIC LINK AUTH\n *\n * Passwordless authentication:\n *\n * ```typescript\n * const { error } = await supabase.auth.signInWithOtp({\n *   email: 'user@example.com',\n *   options: {\n *     emailRedirectTo: 'https://yourapp.com/dashboard'\n *   }\n * })\n * ```\n *\n * User receives email with login link!\n */\n\n/**\n * REF: auth-context-provider\n *\n * ## Context API Provider Pattern\n *\n * ### Why Context?\n * Without Context: Prop Drilling\n * ```\n * App\n *   ‚Üí Layout\n *     ‚Üí Header\n *       ‚Üí Nav\n *         ‚Üí SignOutButton\n *           (user prop passed 4 levels!)\n * ```\n *\n * With Context: Direct Access\n * ```\n * App (AuthProvider)\n *   ...\n *   SignOutButton can useAuth() directly\n * ```\n *\n * ### Context Components\n * - **AuthContext**: Type definition + value\n * - **AuthProvider**: Provider component\n * - **useAuth()**: Hook to use context\n *\n * ### Best Practices\n * - Keep context focused (only auth)\n * - Don't put everything in one context\n * - Use separate contexts for different domains\n * - Consumers can use multiple contexts\n *\n * CLOSE: auth-context-provider\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/lib/storage.ts",
      "content": "/**\n * REF: supabase-storage-utilities\n *\n * # Supabase Storage Utilities\n *\n * Client-side file upload helpers for React + Vite + Supabase.\n *\n * ## Key Concepts\n *\n * - **Supabase Storage** - S3-compatible object storage\n * - **Public buckets** - Accessible without auth\n * - **File validation** - Size and type checking\n * - **Public URLs** - Direct access to files\n *\n * ## Storage Structure\n *\n * ```\n * Buckets:\n *   - profile-pictures (public)\n *   - todo-attachments (public)\n * ```\n */\n\nimport { supabase } from './supabase'\n\n/**\n * REF: upload-profile-picture-supabase\n *\n * ## Upload Profile Picture\n *\n * Uploads user's profile picture to Supabase Storage.\n *\n * ### Parameters\n *\n * | Parameter | Type | Description |\n * |-----------|------|-------------|\n * | `userId` | `string` | User's unique ID |\n * | `file` | `File` | Image file to upload |\n *\n * ### Returns\n *\n * Public URL for the uploaded image.\n *\n * ### Storage Path\n *\n * `profile-pictures/{userId}/{timestamp}-{filename}`\n */\nexport async function uploadProfilePicture(userId: string, file: File): Promise<string> {\n  const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n  if (!allowedTypes.includes(file.type)) {\n    throw new Error('Invalid file type. Only JPEG, PNG, GIF, and WebP are allowed.')\n  }\n\n  const maxSize = 5 * 1024 * 1024\n  if (file.size > maxSize) {\n    throw new Error('File size must be less than 5MB')\n  }\n\n  const timestamp = Date.now()\n  const filename = `${timestamp}-${file.name}`\n  const filePath = `${userId}/${filename}`\n\n  const { data, error } = await supabase.storage\n    .from('profile-pictures')\n    .upload(filePath, file, {\n      cacheControl: '3600',\n      upsert: false,\n    })\n\n  if (error) {\n    throw error\n  }\n\n  const { data: { publicUrl } } = supabase.storage\n    .from('profile-pictures')\n    .getPublicUrl(data.path)\n\n  return publicUrl\n}\n// CLOSE: upload-profile-picture-supabase\n\n/**\n * REF: upload-todo-attachment-supabase\n *\n * ## Upload Todo Attachment\n *\n * Uploads a file attachment for a specific todo.\n *\n * ### Parameters\n *\n * | Parameter | Type | Description |\n * |-----------|------|-------------|\n * | `userId` | `string` | User's unique ID |\n * | `todoId` | `string` | Todo's unique ID |\n * | `file` | `File` | File to attach |\n *\n * ### Returns\n *\n * Object with file metadata.\n */\nexport async function uploadTodoAttachment(\n  userId: string,\n  todoId: string,\n  file: File\n): Promise<{\n  fileName: string\n  fileUrl: string\n  fileSize: number\n  mimeType: string\n}> {\n  const maxSize = 5 * 1024 * 1024\n  if (file.size > maxSize) {\n    throw new Error('File size must be less than 5MB')\n  }\n\n  const timestamp = Date.now()\n  const sanitizedName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_')\n  const filename = `${timestamp}-${sanitizedName}`\n  const filePath = `${userId}/${todoId}/${filename}`\n\n  const { data, error } = await supabase.storage\n    .from('todo-attachments')\n    .upload(filePath, file, {\n      cacheControl: '3600',\n      upsert: false,\n    })\n\n  if (error) {\n    throw error\n  }\n\n  const { data: { publicUrl } } = supabase.storage\n    .from('todo-attachments')\n    .getPublicUrl(data.path)\n\n  return {\n    fileName: file.name,\n    fileUrl: publicUrl,\n    fileSize: file.size,\n    mimeType: file.type,\n  }\n}\n// CLOSE: upload-todo-attachment-supabase\n\n/**\n * REF: delete-file-supabase\n *\n * ## Delete File from Storage\n *\n * Removes a file from Supabase Storage.\n */\nexport async function deleteFile(bucket: string, filePath: string): Promise<void> {\n  try {\n    const { error } = await supabase.storage\n      .from(bucket)\n      .remove([filePath])\n\n    if (error) {\n      console.error('Error deleting file:', error)\n    }\n  } catch (error) {\n    console.error('Error deleting file:', error)\n  }\n}\n// CLOSE: delete-file-supabase\n\n/**\n * REF: validation-helpers-supabase\n *\n * ## File Validation Helpers\n */\nexport function validateImageFile(file: File): boolean {\n  const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n  const maxSize = 5 * 1024 * 1024\n  return allowedTypes.includes(file.type) && file.size <= maxSize\n}\n\nexport function validateAttachmentFile(file: File): boolean {\n  const maxSize = 5 * 1024 * 1024\n  return file.size <= maxSize\n}\n\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i]\n}\n// CLOSE: validation-helpers-supabase\n// CLOSE: supabase-storage-utilities\n",
      "language": "typescript"
    },
    {
      "path": "src/lib/supabase.ts",
      "content": "/**\n * REF: Supabase Client Configuration\n *\n * Initializes and exports the Supabase client for a client-side-only React SPA.\n * All database operations, authentication, and real-time subscriptions go through this client.\n *\n * CLOSE: This file is a singleton configuration module. Import and use the exported\n * `supabase` client in any component that needs database, auth, or storage operations.\n *\n * ## Architecture\n * | `Component` | Purpose |\n * |-----------|---------|\n * | supabase client | Main entry point for all Supabase operations |\n * | Database (PostgreSQL) | Data persistence and querying |\n * | `Auth` | User authentication and session management |\n * | `Storage` | File uploads and serving |\n * | `Realtime` | WebSocket subscriptions for live updates |\n *\n * ## Tech Stack\n * - Supabase JS client library (auto-generated REST API wrapper)\n * - TypeScript with Database type safety (optional)\n * - JWT authentication (managed by Supabase)\n * - WebSocket for real-time features\n *\n * ## Key Concepts\n * - Client-side Supabase (no backend server needed)\n * - PostgreSQL with Row Level Security (RLS)\n * - Real-time subscriptions via PostgreSQL LISTEN/NOTIFY\n * - localStorage session persistence\n * - Auto-refresh tokens before expiry\n *\n * ENVIRONMENT VARIABLES (Vite):\n * | `Variable` | `Source` | `Required` |\n * |----------|--------|----------|\n * | `VITE_SUPABASE_URL` | Supabase dashboard | `Yes` |\n * | `VITE_SUPABASE_ANON_KEY` | Supabase dashboard | `Yes` |\n *\n * Implementation Details:\n * - Must use VITE_ prefix for Vite to expose to client\n * - Values are embedded at build time (not runtime variables)\n * - Anon key is public and safe to expose (RLS enforces security)\n * - Auto-refresh keeps sessions alive across page reloads\n */\n\nimport { createClient } from '@supabase/supabase-js'\nimport type { Database } from './database.types'\n\n/**\n * SUPABASE CLIENT INITIALIZATION\n *\n * Creates a Supabase client for all database operations\n *\n * ### Parameters\n * - supabaseUrl: Your project URL from Supabase dashboard\n * - supabaseAnonKey: Public anonymous key (safe to expose)\n *\n * TYPE SAFETY:\n * - Database type provides full TypeScript autocomplete\n * - Generate with: npx supabase gen types typescript\n * - Optional but highly recommended!\n */\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables')\n}\n\nexport const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    /**\n     * AUTH CONFIGURATION\n     *\n     * storage: Where to store auth tokens\n     * - 'local': localStorage (persists after browser close)\n     * - 'session': sessionStorage (clears on tab close)\n     *\n     * autoRefreshToken: Automatically refresh expired tokens\n     * persistSession: Remember user between page reloads\n     */\n    storage: window.localStorage,\n    autoRefreshToken: true,\n    persistSession: true,\n  },\n})\n\n/**\n * CLIENT-SIDE SUPABASE FEATURES\n *\n * 1. **Database Operations:**\n * ```typescript\n * // SELECT\n * const { data, error } = await supabase\n *   .from('todos')\n *   .select('*')\n *\n * // INSERT\n * const { data, error } = await supabase\n *   .from('todos')\n *   .insert({ title: 'New todo', user_id: user.id })\n *   .select()\n *   .single()\n *\n * // UPDATE\n * const { error } = await supabase\n *   .from('todos')\n *   .update({ completed: true })\n *   .eq('id', todoId)\n *\n * // DELETE\n * const { error } = await supabase\n *   .from('todos')\n *   .delete()\n *   .eq('id', todoId)\n * ```\n *\n * 2. **Authentication:**\n * ```typescript\n * // Sign up\n * const { data, error } = await supabase.auth.signUp({\n *   email: 'user@example.com',\n *   password: 'password123',\n * })\n *\n * // Sign in\n * const { data, error } = await supabase.auth.signInWithPassword({\n *   email: 'user@example.com',\n *   password: 'password123',\n * })\n *\n * // Sign out\n * const { error } = await supabase.auth.signOut()\n *\n * // Get current user\n * const { data: { user } } = await supabase.auth.getUser()\n * ```\n *\n * 3. **Storage:**\n * ```typescript\n * // Upload file\n * const { data, error } = await supabase.storage\n *   .from('attachments')\n *   .upload(`${userId}/${filename}`, file)\n *\n * // Get public URL\n * const { data } = supabase.storage\n *   .from('attachments')\n *   .getPublicUrl(path)\n * ```\n *\n * 4. **Real-time Subscriptions:**\n * ```typescript\n * const channel = supabase\n *   .channel('todos')\n *   .on('postgres_changes', {\n *     event: '*',\n *     schema: 'public',\n *     table: 'todos',\n *     filter: `user_id=eq.${userId}`\n *   }, (payload) => {\n *     console.log('Change detected:', payload)\n *   })\n *   .subscribe()\n *\n * // Cleanup\n * supabase.removeChannel(channel)\n * ```\n */\n\n/**\n * AUTH STATE LISTENER\n *\n * Listen for auth changes (login, logout, token refresh)\n *\n * ```typescript\n * supabase.auth.onAuthStateChange((event, session) => {\n *   if (event === 'SIGNED_IN') {\n *     console.log('User signed in:', session.user)\n *   }\n *   if (event === 'SIGNED_OUT') {\n *     console.log('User signed out')\n *   }\n * })\n * ```\n *\n * Use this in AuthContext to manage global auth state\n */\n\n/**\n * ROW LEVEL SECURITY\n *\n * Security is enforced at the database level:\n *\n * ```sql\n * -- Only see own todos\n * CREATE POLICY \"Users see own todos\"\n * ON todos FOR SELECT\n * USING (auth.uid() = user_id);\n *\n * -- Only update own todos\n * CREATE POLICY \"Users update own todos\"\n * ON todos FOR UPDATE\n * USING (auth.uid() = user_id);\n * ```\n *\n * Even if client code tries to access other users' data,\n * database will reject it. Security layer below application!\n */\n\n/**\n * TYPE SAFETY\n *\n * Generate types from database:\n * ```bash\n * npx supabase gen types typescript --project-id YOUR_PROJECT_ID > src/lib/database.types.ts\n * ```\n *\n * Then use in queries:\n * ```typescript\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n * // data is fully typed as Todo[]!\n * ```\n */\n\n/**\n * ERROR HANDLING PATTERN\n *\n * Always check for errors:\n *\n * ```typescript\n * const { data, error } = await supabase\n *   .from('todos')\n *   .select('*')\n *\n * if (error) {\n *   console.error('Error:', error.message)\n *   throw error\n * }\n *\n * // Safe to use data here\n * console.log(data)\n * ```\n */\n\n/**\n * DEPLOYMENT\n *\n * Build for production:\n * ```bash\n * npm run build\n * ```\n *\n * Deploy `dist/` folder to:\n * - Vercel\n * - Netlify\n * - Firebase Hosting\n * - GitHub Pages\n * - Any static host\n *\n * Environment variables in hosting platform:\n * - VITE_SUPABASE_URL\n * - VITE_SUPABASE_ANON_KEY\n */\n\n/**\n * SUPABASE vs FIREBASE\n *\n * | Feature | `Supabase` | `Firebase` |\n * |---------|----------|----------|\n * | `Database` | PostgreSQL (SQL) | Firestore (NoSQL) |\n * | Open Source | `Yes` | `No` |\n * | Self-hostable | `Yes` | `No` |\n * | Real-time | Built-in (Postgres) | Separate service |\n * | `Security` | RLS (powerful) | Security Rules |\n * | `Pricing` | `Cheaper` | More expensive |\n * | `Maturity` | `Newer` | Well-established |\n */\n\n/**\n * PERFORMANCE TIPS\n *\n * 1. **Use select() to limit columns:**\n * ```typescript\n * // ‚ùå Fetches all columns\n * .from('todos').select('*')\n *\n * // ‚úÖ Only fetches needed columns\n * .from('todos').select('id, title, completed')\n * ```\n *\n * 2. **Add indexes for frequently queried columns:**\n * ```sql\n * CREATE INDEX idx_todos_user_id ON todos(user_id);\n * CREATE INDEX idx_todos_created_at ON todos(created_at DESC);\n * ```\n *\n * 3. **Use .single() when expecting one result:**\n * ```typescript\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *   .eq('id', todoId)\n *   .single() // Returns object instead of array\n * ```\n *\n * 4. **Limit results with pagination:**\n * ```typescript\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *   .range(0, 9) // First 10 items\n * ```\n */\n\nexport default supabase\n\n/**\n * REF: supabase-initialization\n *\n * ## Supabase Client Setup\n *\n * ### Environment Variables\n * - VITE_SUPABASE_URL: Your project URL\n * - VITE_SUPABASE_ANON_KEY: Public JWT key\n *\n * ### Why Anon Key is Safe\n * - Marked \"anonymous\" for public access\n * - Actual security is RLS policies\n * - All queries must pass RLS checks\n * - Cannot bypass restrictions\n * - Like having a bodyguard check ID\n *\n * ### Auth Configuration\n * - storage: localStorage (persists session)\n * - autoRefreshToken: Keep tokens valid\n * - persistSession: Remember after reload\n *\n * ### Type Safety\n * Database interface provides autocomplete\n * - Full TypeScript support\n * - Compile-time error checking\n * - Runtime query validation\n * - Intellisense in IDE\n *\n * CLOSE: supabase-initialization\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/main.tsx",
      "content": "/**\n * REF: Application Entry Point\n *\n * Bootstrap module that mounts the React application to the DOM.\n * Handles React initialization, strict mode, and root setup.\n *\n * CLOSE: This is the very first file executed. It finds the #root element in HTML,\n * creates a React root, and renders the App component with StrictMode enabled.\n *\n * ## Execution Flow\n * 1. Vite loads main.tsx on page load\n * 2. import statements are parsed\n * 3. React and ReactDOM libraries are loaded\n * 4. App component is loaded\n * 5. CSS is injected into document\n * 6. ReactDOM.createRoot() finds #root div in HTML\n * 7. StrictMode wrapper is applied\n * 8. App component is rendered\n * 9. AuthProvider and BrowserRouter initialize\n * 10. Initial route and components are rendered\n *\n * ## Tech Stack\n * | `Component` | `Role` |\n * |-----------|------|\n * | `ReactDOM` | React rendering engine |\n * | React 18 | Concurrent rendering features |\n * | `StrictMode` | Development helper for detecting issues |\n * | `App` | Root application component |\n * | Tailwind CSS | Utility-first CSS framework |\n *\n * FILE REFERENCES:\n * - ./App.tsx - Root component with routing\n * - ./index.css - Global styles with Tailwind directives\n *\n * VITE HOT MODULE REPLACEMENT:\n * - In development, changes are detected immediately\n * - Component state is preserved across edits (when possible)\n * - Error overlay shows compilation issues\n * - No full page reload needed\n *\n * PRODUCTION BUILD:\n * - npm run build creates dist/ folder\n * - Files are minified and bundled\n * - Assets get content-hash filenames for caching\n * - Source maps are created for debugging (optional)\n *\n * ## Key Concepts\n * - Entry point for entire application\n * - Mounts to single <div id=\"root\"> in HTML\n * - StrictMode helps catch React best practice violations\n * - React 18 enables concurrent rendering\n * - All subsequent components inherit from here\n */\n\n  /** REF: imports\n   */\nimport React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App.tsx'\nimport './index.css'\n  // CLOSE: imports\n\n/**\n * RENDER APPLICATION\n *\n * React 18 concurrent features enabled\n * StrictMode helps find bugs in development\n */\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n)\n\n/**\n * REACT + SUPABASE ARCHITECTURE\n *\n * Simple but powerful:\n * - Frontend: React (UI, state, routing)\n * - Backend: Supabase (auth, database, storage)\n * - Database: PostgreSQL (SQL power)\n * - Security: RLS (database-level)\n * - Deployment: Static files (cheap!)\n *\n * All from the browser:\n * ```typescript\n * import { supabase } from './lib/supabase'\n *\n * // Query PostgreSQL from browser\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *\n * // RLS ensures you only get your data\n * ```\n */\n\n/**\n * VITE HOT MODULE REPLACEMENT\n *\n * In development, Vite provides:\n * - Instant HMR (hot module replacement)\n * - Preserves component state\n * - Shows errors as overlay\n * - No full page reload\n *\n * This is why Vite is so fast!\n */\n\n/**\n * PRODUCTION BUILD\n *\n * When you run: npm run build\n *\n * Vite creates:\n * - dist/index.html (entry point)\n * - dist/assets/main-[hash].js (app bundle)\n * - dist/assets/main-[hash].css (styles)\n *\n * Hashed filenames enable:\n * - Long-term caching\n * - Cache busting on updates\n * - Parallel downloads\n */\n\n/**\n * REF: react-18-features\n *\n * ## React 18 New Features\n *\n * ### Concurrent Rendering\n * React 18 can pause and resume rendering:\n * - Low-priority updates don't block UI\n * - Typing stays responsive during rendering\n * - Complex renders don't freeze app\n * - User interactions always prioritized\n *\n * ### Automatic Batching\n * Multiple state updates happen together:\n * ```typescript\n * setTitle(...)\n * setDescription(...)\n * // Both batched into one render\n * ```\n *\n * ### useTransition Hook\n * Mark updates as non-urgent:\n * ```typescript\n * const [isPending, startTransition] = useTransition()\n *\n * startTransition(() => {\n *   setSearchResults(...)  // Low priority\n * })\n *\n * {isPending && <Spinner />}\n * ```\n *\n * ### Suspense for Data\n * Lazy load components with data:\n * ```typescript\n * <Suspense fallback={<Loading />}>\n *   <UserProfile />\n * </Suspense>\n * ```\n *\n * CLOSE: react-18-features\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/Dashboard.tsx",
      "content": "/**\n * REF: User Todo Dashboard Page\n *\n * Main application page where authenticated users manage their todos.\n * Handles CRUD operations, real-time updates, and RLS-protected queries.\n *\n * CLOSE: Protected route. Shows todo creation form and list of user's todos.\n * Demonstrates full Supabase integration with real-time subscriptions.\n *\n * PAGE STRUCTURE:\n * | `Section` | Purpose |\n * |---------|---------|\n * | `Header` | Page title \"My Todos\" |\n * | Error Alert | Display operation errors |\n * | Create Form | Input fields for new todo |\n * | Todos List | Grid/list of existing todos |\n * | Empty State | Message when no todos exist |\n *\n * ## Functionality\n *\n * | Operation | HTTP Method | SQL |\n * |-----------|-------------|-----|\n * | Fetch todos | `GET` | `SELECT * FROM todos WHERE user_id = auth.uid()` |\n * | Create todo | `POST` | `INSERT INTO todos (...) VALUES (...)` |\n * | Toggle complete | `PATCH` | `UPDATE todos SET completed = !completed WHERE id = ?` |\n * | Delete todo | `DELETE` | `DELETE FROM todos WHERE id = ?` |\n *\n * ## State Management\n *\n * | State | Type | Purpose |\n * |-------|------|---------|\n * | `todos` | `Todo[]` | All user's todos |\n * | `loading` | `boolean` | Initial data load |\n * | `error` | `string` | Operation error messages |\n * | `title` | `string` | Create form title input |\n * | `description` | `string` | Create form description input |\n * | `isPublic` | `boolean` | Create form visibility toggle |\n *\n * ## Lifecycle\n *\n * 1. Component mounts\n * 2. Check auth status via `useAuth()` hook\n * 3. Fetch todos from PostgreSQL via Supabase client\n * 4. Subscribe to real-time changes\n * 5. Render todos list with current data\n * 6. User can create, toggle, or delete todos\n * 7. All operations go through Supabase client API\n * 8. Real-time subscription fires on database changes\n * 9. Todos refetch and UI updates\n * 10. Component unmounts, unsubscribe from channel\n *\n * ROW LEVEL SECURITY:\n * ```sql\n * CREATE POLICY \"Users see own todos\"\n * ON todos FOR SELECT\n * USING (auth.uid() = user_id);\n *\n * CREATE POLICY \"Users update own todos\"\n * ON todos FOR UPDATE\n * USING (auth.uid() = user_id);\n *\n * CREATE POLICY \"Users delete own todos\"\n * ON todos FOR DELETE\n * USING (auth.uid() = user_id);\n *\n * CREATE POLICY \"Users insert own todos\"\n * ON todos FOR INSERT\n * WITH CHECK (auth.uid() = user_id);\n * ```\n * Security enforced at database level, not in application!\n *\n * REAL-TIME SUBSCRIPTIONS:\n * - PostgreSQL LISTEN/NOTIFY underneath\n * - Supabase broadcasts changes via WebSocket\n * - Filters by user_id in subscription\n * - Events: INSERT, UPDATE, DELETE\n * - Low latency (usually < 100ms)\n * - Refetch on any change\n *\n * SUPABASE OPERATIONS:\n * ```typescript\n * // SELECT\n * .from('todos').select('*')\n *   .eq('user_id', user.id)\n *   .order('created_at', { ascending: false })\n *\n * // INSERT\n * .from('todos').insert({\n *   user_id, title, description, is_public, completed: false\n * }).select().single()\n *\n * // UPDATE\n * .from('todos').update({ completed: !completed })\n *   .eq('id', todoId)\n *\n * // DELETE\n * .from('todos').delete().eq('id', todoId)\n *\n * // SUBSCRIBE\n * .channel('todos-changes').on(\n *   'postgres_changes',\n *   { event: '*', schema: 'public', table: 'todos', filter: `user_id=eq.${userId}` },\n *   callback\n * ).subscribe()\n * ```\n *\n * ## Error Handling\n * | `Scenario` | `Error` | `Handling` |\n * |----------|-------|----------|\n * | No todos | `None` | Shows empty state message |\n * | RLS violation | \"policy violation\" | Shows error, keeps data |\n * | Network error | Connection error | Shows error message |\n * | Validation error | Missing title | Shows error before submit |\n *\n * FILE REFERENCES:\n * - ../lib/supabase.ts - Supabase client\n * - ../contexts/AuthContext.tsx - useAuth() hook\n * - ../components/TodoList.tsx - Todo list display\n * - ../components/TodoForm.tsx - Todo creation form\n * - ../App.tsx - Route definition\n *\n * ## Key Concepts\n * - Client-side CRUD without backend server\n * - Real-time data synchronization\n * - Row Level Security at database\n * - JWT token in every request\n * - Optimistic updates possible\n */\n\nimport { useState, useEffect } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\nimport { supabase } from '../lib/supabase'\n\n/**\n * TODO TYPE\n *\n * Could import from generated database.types.ts\n * For simplicity, defining inline here\n */\ninterface Todo {\n  id: string\n  user_id: string\n  title: string\n  description?: string | null\n  completed: boolean\n  is_public: boolean\n  tags?: string[] | null\n  created_at: string\n  updated_at: string\n}\n\nexport default function Dashboard() {\n  const { user, loading: authLoading } = useAuth()\n  const navigate = useNavigate()\n\n  const [todos, setTodos] = useState<Todo[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState('')\n\n  // Form state\n  const [title, setTitle] = useState('')\n  const [description, setDescription] = useState('')\n  const [isPublic, setIsPublic] = useState(false)\n\n  /**\n   * AUTH REDIRECT\n   */\n  useEffect(() => {\n    if (!authLoading && !user) {\n      navigate('/signin')\n    }\n  }, [user, authLoading, navigate])\n\n  /**\n   * FETCH TODOS FROM POSTGRESQL\n   *\n   * Supabase query from browser\n   *\n   * SUPABASE CLIENT QUERY:\n   * - .from('todos'): Select table\n   * - .select('*'): Get all columns\n   * - .eq('user_id', user.id): WHERE user_id = user.id\n   * - .order('created_at', { ascending: false }): ORDER BY\n   *\n   * RLS IN ACTION:\n   * Even though we query all todos, RLS automatically filters:\n   * ```sql\n   * SELECT * FROM todos\n   * WHERE user_id = auth.uid() OR is_public = true\n   * ```\n   *\n   * User only sees their own data!\n   */\n  useEffect(() => {\n    if (!user) return\n\n    const fetchTodos = async () => {\n      const { data, error } = await supabase\n        .from('todos')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false })\n\n      if (error) {\n        console.error('Error:', error)\n        setError('Failed to load todos')\n      } else {\n        setTodos(data || [])\n      }\n\n      setLoading(false)\n    }\n\n    fetchTodos()\n\n    /**\n     * REAL-TIME SUBSCRIPTION\n     *\n     * Listen to database changes in real-time\n     *\n     * SUPABASE REALTIME:\n     * - PostgreSQL LISTEN/NOTIFY under the hood\n     * - Broadcasts changes to all connected clients\n     * - Filter at database level\n     * - Low latency, high performance\n     *\n     * ## Events\n     * - INSERT: New row created\n     * - UPDATE: Row modified\n     * - DELETE: Row removed\n     * - * (all): Listen to all events\n     */\n    const channel = supabase\n      .channel('todos-changes')\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'todos',\n          filter: `user_id=eq.${user.id}`,\n        },\n        (payload) => {\n          console.log('Todo changed:', payload)\n          fetchTodos() // Refetch on any change\n        }\n      )\n      .subscribe()\n\n    return () => {\n      supabase.removeChannel(channel)\n    }\n  }, [user])\n\n  /**\n   * CREATE TODO\n   *\n   * Insert into PostgreSQL via Supabase\n   *\n   * SUPABASE INSERT:\n   * - .insert(): Add new row\n   * - .select().single(): Return inserted row\n   * - Auto-generates UUID\n   * - RLS validates user_id matches auth.uid()\n   */\n  const handleCreateTodo = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!user || !title.trim()) return\n\n    const { data, error } = await supabase\n      .from('todos')\n      .insert({\n        user_id: user.id,\n        title: title.trim(),\n        description: description.trim() || null,\n        is_public: isPublic,\n        completed: false,\n      })\n      .select()\n      .single()\n\n    if (error) {\n      console.error('Error:', error)\n      setError('Failed to create todo')\n      return\n    }\n\n    // Real-time will update, or manually add\n    setTodos([data, ...todos])\n\n    // Reset form\n    setTitle('')\n    setDescription('')\n    setIsPublic(false)\n  }\n\n  /**\n   * UPDATE TODO\n   *\n   * Modify existing row\n   *\n   * RLS CHECK:\n   * - Policy ensures user_id = auth.uid()\n   * - Cannot update other users' todos\n   * - Database blocks unauthorized updates\n   */\n  const handleToggleComplete = async (todoId: string, completed: boolean) => {\n    const { error } = await supabase\n      .from('todos')\n      .update({ completed: !completed })\n      .eq('id', todoId)\n\n    if (error) {\n      console.error('Error:', error)\n      setError('Failed to update todo')\n    }\n\n    // Update local state optimistically\n    setTodos(todos.map(t =>\n      t.id === todoId ? { ...t, completed: !completed } : t\n    ))\n  }\n\n  /**\n   * DELETE TODO\n   *\n   * Remove from database\n   *\n   * ## Cascade Delete\n   * - If attachments have ON DELETE CASCADE\n   * - They're automatically deleted too\n   * - Must delete files from Storage separately!\n   */\n  const handleDeleteTodo = async (todoId: string) => {\n    if (!confirm('Delete this todo?')) return\n\n    const { error } = await supabase\n      .from('todos')\n      .delete()\n      .eq('id', todoId)\n\n    if (error) {\n      console.error('Error:', error)\n      setError('Failed to delete todo')\n      return\n    }\n\n    // Update local state\n    setTodos(todos.filter(t => t.id !== todoId))\n  }\n\n  if (authLoading || loading) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center\">\n        <div className=\"text-xl\">Loading...</div>\n      </div>\n    )\n  }\n\n  if (!user) return null\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-8\">\n      <div className=\"container mx-auto max-w-4xl\">\n        <h1 className=\"text-4xl font-bold mb-8\">My Todos</h1>\n\n        {error && (\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6\">\n            {error}\n          </div>\n        )}\n\n        {/* Create Form */}\n        <form onSubmit={handleCreateTodo} className=\"bg-white rounded-lg shadow p-6 mb-6\">\n          <h2 className=\"text-2xl font-bold mb-4\">Create New Todo</h2>\n\n          {/** REF: create-todo-form-fields\n           * Form fields for creating a new todo item.\n           * Includes title input, description textarea, and public checkbox.\n           */}\n          <div className=\"space-y-4\">\n            <input\n              type=\"text\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              placeholder=\"What needs to be done?\"\n              required\n              className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n            />\n\n            {/** REF: description-textarea-field\n             * Textarea for optional todo description.\n             * Provides 3 rows for detailed input.\n             */}\n            <textarea\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              placeholder=\"Description (optional)\"\n              rows={3}\n              className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n            />\n            {/* CLOSE: description-textarea-field */}\n\n            {/** REF: public-checkbox-field\n             * Checkbox to mark todo as public.\n             * Toggles visibility for other users.\n             */}\n            <label className=\"flex items-center gap-2\">\n              <input\n                type=\"checkbox\"\n                checked={isPublic}\n                onChange={(e) => setIsPublic(e.target.checked)}\n                className=\"w-4 h-4\"\n              />\n              <span className=\"text-sm\">Make public</span>\n            </label>\n            {/* CLOSE: public-checkbox-field */}\n\n                  <button\n              type=\"submit\"\n              className=\"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition\"\n            >\n              Create Todo\n            </button>\n          </div>\n          {/* CLOSE: create-todo-form-fields */}\n        </form>\n\n              {/* Todos List */}\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-2xl font-bold mb-4\">Your Todos</h2>\n\n          {todos.length === 0 ? (\n            <p className=\"text-gray-500 text-center py-8\">\n              No todos yet. Create one above!\n            </p>\n          ) : (\n                  <div className=\"space-y-3\">\n              {todos.map(todo => (\n                <div\n                  key={todo.id}\n                  className=\"p-4 bg-gray-50 rounded-lg flex items-start gap-4\"\n                >\n                        <input\n                    type=\"checkbox\"\n                    checked={todo.completed}\n                    onChange={() => handleToggleComplete(todo.id, todo.completed)}\n                    className=\"mt-1 w-5 h-5\"\n                  />\n\n                        <div className=\"flex-1\">\n                    <h3 className={`font-medium ${todo.completed ? 'line-through text-gray-500' : ''}`}>\n                      {todo.title}\n                    </h3>\n                    {todo.description && (\n                      <p className=\"text-sm text-gray-600 mt-1\">{todo.description}</p>\n                    )}\n                          {todo.tags && todo.tags.length > 0 && (\n                      <div className=\"flex flex-wrap gap-2 mt-2\">\n                        {todo.tags.map(tag => (\n                          <span key={tag} className=\"px-2 py-1 bg-blue-100 text-xs rounded-full\">\n                            #{tag}\n                          </span>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n\n                        <button\n                    onClick={() => handleDeleteTodo(todo.id)}\n                    className=\"p-2 text-red-600 hover:bg-red-50 rounded transition\"\n                  >\n                    üóëÔ∏è\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n/**\n * SUPABASE ERROR HANDLING\n *\n * All Supabase operations return { data, error }\n *\n * ALWAYS check error:\n * ```typescript\n * const { data, error } = await supabase.from('todos').select()\n *\n * if (error) {\n *   console.error(error)\n *   // Handle error\n *   return\n * }\n *\n * // Safe to use data\n * ```\n *\n * Common errors:\n * - \"new row violates row-level security policy\": RLS blocked operation\n * - \"duplicate key value\": Unique constraint violation\n * - \"null value in column\": NOT NULL constraint\n * - \"foreign key constraint\": Referenced row doesn't exist\n */\n\n/**\n * TYPE GENERATION\n *\n * Generate types from database:\n * ```bash\n * npx supabase gen types typescript --project-id YOUR_PROJECT > src/lib/database.types.ts\n * ```\n *\n * Then import and use:\n * ```typescript\n * import type { Database } from '../lib/database.types'\n *\n * type Todo = Database['public']['Tables']['todos']['Row']\n *\n * const [todos, setTodos] = useState<Todo[]>([])\n * ```\n *\n * Full autocomplete and type safety!\n */\n\n/**\n * ADVANCED POSTGRESQL QUERIES\n *\n * Supabase client supports advanced features:\n *\n * ```typescript\n * // Full-text search\n * .textSearch('title', 'search term')\n *\n * // Array contains\n * .contains('tags', ['urgent'])\n *\n * // Range queries\n * .gte('created_at', yesterday)\n * .lte('created_at', today)\n *\n * // Joins\n * .select('*, user_profiles(*)')\n *\n * // Aggregations\n * .select('*', { count: 'exact' })\n *\n * // Pagination\n * .range(0, 9) // First 10 items\n *\n * // RPC (call PostgreSQL functions)\n * .rpc('search_todos', { search_term: 'term' })\n * ```\n */\n\n/**\n * REF: dashboard-data-flow\n *\n * ## Data Flow in Dashboard\n *\n * ### Initial Load\n * 1. Component mounts\n * 2. useEffect checks auth (redirect if not)\n * 3. Another useEffect sets up listener\n * 4. Supabase subscribes to user's todos\n * 5. Returns current data immediately\n * 6. Continues listening for changes\n *\n * ### Real-Time Updates\n * When another tab/device updates a todo:\n * 1. PostgreSQL LISTEN notifies subscriptions\n * 2. Supabase sends update via WebSocket\n * 3. Listener callback fires\n * 4. setTodos updates state\n * 5. Component re-renders with new data\n *\n * ### RLS Security\n * Query automatically filters by user:\n * ```sql\n * WHERE user_id = current_user_id\n * ```\n * - Database enforces at query time\n * - Cannot see other users' todos\n * - Cannot access other users' data\n * - Even admin can't see without RLS bypass\n *\n * CLOSE: dashboard-data-flow\n */\n\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/Feed.tsx",
      "content": "/**\n * REF: Public Todo Feed Page\n *\n * Displays public todos shared by all users. Features search, tag filtering,\n * and real-time updates. Accessible to authenticated users only.\n *\n * CLOSE: Protected page that shows all public todos with search and filtering.\n * Uses Supabase real-time to update feed when new public todos are created.\n *\n * PAGE STRUCTURE:\n * | `Component` | Purpose |\n * |-----------|---------|\n * | `Title` | \"Public Feed\" heading |\n * | `Count` | \"N public todos shared by the community\" |\n * | Search Input | Full-text search on title/description |\n * | Tag Filter | Buttons to filter by tag |\n * | Results Count | \"Showing X of Y\" |\n * | Todo Cards | Grid of public todos |\n * | Empty State | \"No todos found\" message |\n *\n * ## Data Sources\n * - Fetches todos WHERE is_public = true\n * - Orders by created_at descending (newest first)\n * - Limits to 50 results\n * - Includes user_id for attribution (optional)\n *\n * FILTERING FEATURES:\n * | Feature | Type | `Location` |\n * |---------|------|----------|\n * | `Search` | Text input | Top of page |\n * | `Tags` | Toggle buttons | Below search |\n * | `Combined` | Both filters | Applied simultaneously |\n *\n * SEARCH BEHAVIOR:\n * - Client-side filtering (all todos in memory)\n * - Matches title OR description\n * - Case-insensitive\n * - Filters after fetch (not server-side)\n *\n * TAG FILTERING:\n * - Extracts all unique tags from todos\n * - Creates toggle buttons for each tag\n * - Click to filter todos with that tag\n * - Click again to deselect tag\n * - Can only filter one tag at a time (current implementation)\n *\n * REAL-TIME UPDATES:\n * ```typescript\n * .channel('public-todos')\n *   .on('postgres_changes', {\n *     event: '*',\n *     schema: 'public',\n *     table: 'todos',\n *     filter: 'is_public=eq.true'\n *   }, (payload) => {\n *     // Refetch todos when public todos change\n *   })\n * ```\n * Updates happen instantly when:\n * - New public todo created\n * - Todo made public (is_public = true)\n * - Todo deleted\n *\n * STATE MANAGEMENT:\n * | `State` | Type | Purpose |\n * |-------|------|---------|\n * | `todos` | `Todo[]` | All fetched public todos |\n * | `filteredTodos` | `Todo[]` | After search/tag filter |\n * | `searchTerm` | `string` | Current search input |\n * | `selectedTag` | string \\| `null` | Currently selected tag |\n * | `loading` | `boolean` | Initial fetch in progress |\n *\n * SUPABASE QUERY:\n * ```typescript\n * const { data } = await supabase\n *   .from('todos')\n *   .select('*')\n *   .eq('is_public', true)\n *   .order('created_at', { ascending: false })\n *   .limit(50)\n * ```\n *\n * TODO CARD DISPLAY:\n * | `Field` | `Display` |\n * |-------|---------|\n * | `Title` | Large bold text |\n * | Description | Gray text below title |\n * | `Tags` | Hashtag prefix in gray chips |\n * | `Completed` | Not shown (feed is public todos) |\n * | `User` | Not shown (anonymous) |\n *\n * ## Styling\n * - Responsive grid (1 col mobile, 2-3 cols desktop)\n * - White cards with shadow\n * - Gray background page\n * - Rounded corners and padding\n * - Hover effects on tag buttons\n * - Fixed spacing with Tailwind\n *\n * FILE REFERENCES:\n * - ../lib/supabase.ts - Supabase client\n * - ../contexts/AuthContext.tsx - useAuth() for protected access\n * - ../App.tsx - Route definition\n *\n * ## Key Concepts\n * - Client-side filtering reduces server load\n * - Real-time public feed\n * - RLS allows anyone to see public todos\n * - No user attribution (privacy)\n * - Hashtag search pattern\n * - Read-only feed (no create/edit/delete)\n */\n\nimport { useState, useEffect } from 'react'\nimport { supabase } from '../lib/supabase'\n\ninterface Todo {\n  id: string\n  user_id: string\n  title: string\n  description: string | null\n  completed: boolean\n  is_public: boolean\n  tags: string[] | null\n  created_at: string\n}\n\n/**\n * REF: feed-page-component\n */\nexport default function Feed() {\n  const [todos, setTodos] = useState<Todo[]>([])\n  const [filteredTodos, setFilteredTodos] = useState<Todo[]>([])\n  const [searchTerm, setSearchTerm] = useState('')\n  const [selectedTag, setSelectedTag] = useState<string | null>(null)\n  const [loading, setLoading] = useState(true)\n\n  /**\n   * FETCH PUBLIC TODOS\n   *\n   * Query PostgreSQL from browser via Supabase\n   */\n  useEffect(() => {\n    const fetchPublicTodos = async () => {\n      const { data, error } = await supabase\n        .from('todos')\n        .select('*')\n        .eq('is_public', true)\n        .order('created_at', { ascending: false })\n        .limit(50)\n\n      if (error) {\n        console.error('Error:', error)\n      } else {\n        setTodos(data || [])\n        setFilteredTodos(data || [])\n      }\n\n      setLoading(false)\n    }\n\n    fetchPublicTodos()\n\n    /**\n     * REAL-TIME SUBSCRIPTION\n     *\n     * Listen for new public todos\n     */\n    const channel = supabase\n      .channel('public-todos')\n      .on('postgres_changes', {\n        event: '*',\n        schema: 'public',\n        table: 'todos',\n        filter: 'is_public=eq.true'\n      }, (payload) => {\n        console.log('Change:', payload)\n        fetchPublicTodos()\n      })\n      .subscribe()\n\n    return () => {\n      supabase.removeChannel(channel)\n    }\n  }, [])\n\n  /**\n   * CLIENT-SIDE FILTERING\n   */\n  useEffect(() => {\n    let results = todos\n\n    if (searchTerm.trim()) {\n      const term = searchTerm.toLowerCase()\n      results = results.filter(\n        t => t.title?.toLowerCase().includes(term) ||\n             t.description?.toLowerCase().includes(term)\n      )\n    }\n\n    if (selectedTag) {\n      results = results.filter(t => t.tags?.includes(selectedTag))\n    }\n\n    setFilteredTodos(results)\n  }, [searchTerm, selectedTag, todos])\n\n  const allTags = Array.from(\n    new Set(todos.flatMap(t => t.tags || []))\n  ).sort()\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div>Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-8\">\n      <div className=\"container mx-auto max-w-6xl\">\n        <h1 className=\"text-4xl font-bold mb-2\">Public Feed</h1>\n        <p className=\"text-gray-600 mb-8\">\n          {todos.length} public todos shared by the community\n        </p>\n\n        {/* Search */}\n        <input\n          type=\"text\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          placeholder=\"Search todos...\"\n          className=\"w-full px-4 py-3 mb-6 border rounded-lg focus:ring-2 focus:ring-purple-500\"\n        />\n\n        {/* Tags */}\n        {allTags.length > 0 && (\n          <div className=\"mb-6\">\n            <h3 className=\"text-sm font-medium mb-2\">Filter by tag:</h3>\n            <div className=\"flex flex-wrap gap-2\">\n              {allTags.map(tag => (\n                <button\n                  key={tag}\n                  onClick={() => setSelectedTag(selectedTag === tag ? null : tag)}\n                  className={`px-4 py-2 rounded-full text-sm ${\n                    selectedTag === tag\n                      ? 'bg-purple-600 text-white'\n                      : 'bg-gray-200 hover:bg-gray-300'\n                  }`}\n                >\n                  #{tag}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Results */}\n        <div className=\"mb-4 text-gray-600\">\n          Showing {filteredTodos.length} of {todos.length}\n        </div>\n\n        {/* Grid */}\n        {filteredTodos.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredTodos.map(todo => (\n              <div key={todo.id} className=\"p-6 bg-white rounded-lg shadow-lg\">\n                <h3 className=\"text-lg font-bold mb-2\">{todo.title}</h3>\n                {todo.description && (\n                  <p className=\"text-gray-600 mb-4\">{todo.description}</p>\n                )}\n                {todo.tags && todo.tags.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {todo.tags.map(tag => (\n                      <span key={tag} className=\"px-2 py-1 bg-gray-100 text-xs rounded-full\">\n                        #{tag}\n                      </span>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"text-center py-12 text-gray-500\">No todos found</div>\n        )}\n      </div>\n    </div>\n  )\n}\n// CLOSE: feed-page-component\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/Landing.tsx",
      "content": "/**\n * REF: Public Landing Page\n *\n * Homepage showcasing the application features and providing entry points\n * for signin and signup. Accessible to all users (no authentication required).\n *\n * CLOSE: This is the first page users see. It displays project description,\n * key features, and navigation buttons to auth pages.\n *\n * PAGE STRUCTURE:\n * | `Section` | Purpose |\n * |---------|---------|\n * | `Header` | Large headline and description |\n * | CTA Buttons | Sign In and Sign Up links |\n * | Feature Cards | 2x2 grid of key features |\n * | `Footer` | Stack information |\n *\n * ## Features Highlighted\n * | Feature | Benefit |\n * |---------|---------|\n * | PostgreSQL Power | Full SQL database with relations |\n * | Lightning Fast | Vite's instant HMR |\n * | Open Source | No vendor lock-in |\n * | Row Level Security | Database-level data protection |\n *\n * ## Routing\n * - Uses React Router Link components (client-side navigation)\n * - No server round-trip, instant navigation\n * - Links to /signin and /signup pages\n *\n * ## Styling\n * - Gradient background (purple to white)\n * - Tailwind CSS utilities\n * - Responsive grid for feature cards\n * - Max-width container for readability\n * - Centered text and flexbox alignment\n *\n * TECH STACK DISPLAY:\n * - Lists all dependencies in footer\n * - Shows integration of React, Vite, Supabase, PostgreSQL, etc.\n *\n * USER JOURNEY:\n * 1. User visits / (root URL)\n * 2. Router renders Landing component\n * 3. User sees features and benefits\n * 4. User clicks \"Sign In\" or \"Sign Up\"\n * 5. Router navigates to /signin or /signup\n * 6. Component unmounts, auth page mounts\n * 7. No server involved, instant page switch\n *\n * ## Key Concepts\n * - Static HTML generated with React\n * - No database queries on this page\n * - Pure presentation layer\n * - Entry point for auth flow\n * - Shows app benefits to convince users to sign up\n */\n\nimport { Link } from 'react-router-dom'\n\n/**\n * REF: landing-page-component\n */\nexport default function Landing() {\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-center p-24 bg-gradient-to-b from-purple-50 to-white\">\n      <div className=\"max-w-2xl text-center\">\n        <h1 className=\"text-5xl font-bold mb-6 text-gray-900\">\n          Welcome to Todo App\n        </h1>\n\n        <p className=\"text-xl text-gray-600 mb-8\">\n          A modern todo application built with React, Vite, and Supabase featuring\n          PostgreSQL database, real-time updates, and Row Level Security.\n        </p>\n\n        <div className=\"flex gap-4 justify-center mb-12\">\n          <Link\n            to=\"/signin\"\n            className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition\"\n          >\n            Sign In\n          </Link>\n          <Link\n            to=\"/signup\"\n            className=\"px-6 py-3 bg-gray-200 rounded-lg hover:bg-gray-300 transition\"\n          >\n            Sign Up\n          </Link>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 text-left\">\n          <div className=\"p-6 bg-white rounded-lg shadow\">\n            <h3 className=\"font-bold text-lg mb-2\">PostgreSQL Power</h3>\n            <p className=\"text-gray-600\">\n              Full SQL database with relations, joins, and advanced queries.\n            </p>\n          </div>\n\n          <div className=\"p-6 bg-white rounded-lg shadow\">\n            <h3 className=\"font-bold text-lg mb-2\">Lightning Fast</h3>\n            <p className=\"text-gray-600\">\n              Vite's instant HMR makes development incredibly fast.\n            </p>\n          </div>\n\n          <div className=\"p-6 bg-white rounded-lg shadow\">\n            <h3 className=\"font-bold text-lg mb-2\">Open Source</h3>\n            <p className=\"text-gray-600\">\n              Built entirely with open-source tools. No vendor lock-in!\n            </p>\n          </div>\n\n          <div className=\"p-6 bg-white rounded-lg shadow\">\n            <h3 className=\"font-bold text-lg mb-2\">Row Level Security</h3>\n            <p className=\"text-gray-600\">\n              Database-level security policies protect your data.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"mt-12 text-sm text-gray-500\">\n          <p>Built with React 18 ‚Ä¢ Vite ‚Ä¢ Supabase ‚Ä¢ PostgreSQL ‚Ä¢ TypeScript ‚Ä¢ Tailwind CSS</p>\n        </div>\n      </div>\n    </main>\n  )\n}\n// CLOSE: landing-page-component\n\n/**\n * REACT + VITE + SUPABASE STACK\n *\n * Why this combination?\n * - React: Popular, well-documented\n * - Vite: Fastest build tool\n * - Supabase: PostgreSQL + auth + storage in one\n * - Open-source: Can self-host everything\n * - Simple: No server needed (SPA)\n * - Powerful: SQL database from browser\n *\n * Perfect for:\n * - Internal tools\n * - CRUD applications\n * - Dashboards\n * - Learning projects\n */\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/Messages.tsx",
      "content": "/**\n * REF: Real-time Messaging Page\n *\n * Two-column messaging interface for direct communication between users.\n * Left column lists users, right column shows conversation with real-time updates.\n *\n * CLOSE: Protected page showing user list and direct messaging conversation.\n * Uses Supabase real-time to instantly show new messages.\n *\n * PAGE LAYOUT:\n * ```\n * ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n * ‚îÇ    MESSAGES HEADER       ‚îÇ\n * ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n * ‚îÇ   USERS     ‚îÇ     CHAT   ‚îÇ\n * ‚îÇ  (1/4 col)  ‚îÇ   (3/4 col)‚îÇ\n * ‚îÇ             ‚îÇ            ‚îÇ\n * ‚îÇ - User 1    ‚îÇ Conversation‚îÇ\n * ‚îÇ - User 2    ‚îÇ + Input     ‚îÇ\n * ‚îÇ - User 3    ‚îÇ            ‚îÇ\n * ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n * ```\n *\n * ## Features\n * | Feature | Purpose |\n * |---------|---------|\n * | User List | Select conversation partner |\n * | `Conversation` | Message history with timestamps |\n * | `Input` | Type and send messages |\n * | Read Status | Shows \"Read\" indicator |\n * | Auto Scroll | Scrolls to latest message |\n *\n * MESSAGE STRUCTURE:\n * | `Field` | Type | Purpose |\n * |-------|------|---------|\n * | `id` | `UUID` | Message identifier |\n * | `sender_id` | `UUID` | Who sent the message |\n * | `recipient_id` | `UUID` | Who receives the message |\n * | `content` | `text` | Message text |\n * | `read` | `boolean` | Whether recipient read it |\n * | `read_at` | `timestamp` | When recipient read it |\n * | `created_at` | `timestamp` | Message timestamp |\n *\n * ## Data Flow\n * 1. Component mounts\n * 2. Fetch user_profiles (list of users)\n * 3. Display all users except current user\n * 4. User clicks a user to select\n * 5. Fetch messages between current user and selected user\n * 6. Subscribe to new messages\n * 7. Mark received messages as read\n * 8. User types and sends message\n * 9. INSERT into messages table\n * 10. Real-time subscription fires\n * 11. New message appears instantly in UI\n * 12. Auto-scroll to newest message\n *\n * QUERY PATTERNS:\n * ```typescript\n * // Fetch users (everyone except current)\n * .from('user_profiles')\n *   .select('id, user_id, display_name')\n *   .neq('user_id', user.id)\n *\n * // Fetch conversation (both directions)\n * .from('messages')\n *   .select('*')\n *   .or(`and(sender_id.eq.${user.id},recipient_id.eq.${selectedUserId}),\n *         and(sender_id.eq.${selectedUserId},recipient_id.eq.${user.id})`)\n *   .order('created_at', { ascending: true })\n *\n * // Mark as read\n * .from('messages')\n *   .update({ read: true, read_at: new Date().toISOString() })\n *   .eq('id', messageId)\n *\n * // Send message\n * .from('messages')\n *   .insert({ sender_id: user.id, recipient_id, content })\n * ```\n *\n * REAL-TIME SUBSCRIPTION:\n * - Subscribes to message INSERT events\n * - Filters by sender or recipient (or uses broadcast)\n * - Shows message if from/to selected user\n * - Auto-marks as read if user is recipient\n * - Scrolls viewport to latest message\n *\n * MESSAGE STYLING:\n * | `Role` | `Alignment` | `Color` | `Bubble` |\n * |------|-----------|-------|--------|\n * | `Sent` | `Right` | `Purple` | with arrow |\n * | `Received` | `Left` | `Gray` | with arrow |\n * | `Time` | Below text | `Gray` | `smaller` |\n * | Read status | After time | `Subtle` | if sent |\n *\n * STATE MANAGEMENT:\n * | `State` | Type | Purpose |\n * |-------|------|---------|\n * | `users` | `User[]` | All available users |\n * | `selectedUserId` | string \\| `null` | Currently selected user |\n * | `messages` | `Message[]` | Messages in conversation |\n * | `newMessage` | `string` | Input field value |\n * | `loading` | `boolean` | Initial data load |\n *\n * UX FEATURES:\n * - User list has hover background\n * - Selected user has purple background\n * - Messages scroll to bottom on new message\n * - Input disabled if no user selected\n * - Shows \"Select a user\" placeholder\n * - Auto-marks messages as read\n * - Displays read receipts for sent messages\n *\n * FILE REFERENCES:\n * - ../lib/supabase.ts - Supabase client\n * - ../contexts/AuthContext.tsx - useAuth() hook\n * - ../App.tsx - Route definition\n *\n * ## Key Concepts\n * - Real-time message delivery\n * - Bi-directional conversations\n * - Read receipts\n * - User presence (implicit via activity)\n * - PostgreSQL JSON queries for OR logic\n * - WebSocket subscriptions\n */\n\nimport { useState, useEffect, useRef } from 'react'\nimport { useAuth } from '../contexts/AuthContext'\nimport { supabase } from '../lib/supabase'\n\ninterface Message {\n  id: string\n  sender_id: string\n  recipient_id: string\n  content: string\n  read: boolean\n  read_at: string | null\n  created_at: string\n}\n\n/**\n * REF: messages-page-component\n */\nexport default function Messages() {\n  const { user } = useAuth()\n\n  const [users, setUsers] = useState<any[]>([])\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null)\n  const [messages, setMessages] = useState<Message[]>([])\n  const [newMessage, setNewMessage] = useState('')\n  const [loading, setLoading] = useState(true)\n\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n\n  /**\n   * FETCH USERS\n   */\n  useEffect(() => {\n    if (!user) return\n\n    const fetchUsers = async () => {\n      const { data } = await supabase\n        .from('user_profiles')\n        .select('id, user_id, display_name')\n        .neq('user_id', user.id)\n\n      setUsers(data || [])\n      setLoading(false)\n    }\n\n    fetchUsers()\n  }, [user])\n\n  /**\n   * FETCH CONVERSATION\n   */\n  useEffect(() => {\n    if (!user || !selectedUserId) {\n      setMessages([])\n      return\n    }\n\n    const fetchMessages = async () => {\n      const { data } = await supabase\n        .from('messages')\n        .select('*')\n        .or(`and(sender_id.eq.${user.id},recipient_id.eq.${selectedUserId}),and(sender_id.eq.${selectedUserId},recipient_id.eq.${user.id})`)\n        .order('created_at', { ascending: true })\n\n      setMessages(data || [])\n\n      // Mark as read\n      data?.forEach(msg => {\n        if (msg.recipient_id === user.id && !msg.read) {\n          supabase\n            .from('messages')\n            .update({ read: true, read_at: new Date().toISOString() })\n            .eq('id', msg.id)\n            .then()\n        }\n      })\n\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\n    }\n\n    fetchMessages()\n\n    /**\n     * REAL-TIME SUBSCRIPTION\n     */\n    const channel = supabase\n      .channel('messages')\n      .on('postgres_changes', {\n        event: 'INSERT',\n        schema: 'public',\n        table: 'messages'\n      }, (payload) => {\n        const newMsg = payload.new as Message\n\n        if (\n          (newMsg.sender_id === user.id && newMsg.recipient_id === selectedUserId) ||\n          (newMsg.sender_id === selectedUserId && newMsg.recipient_id === user.id)\n        ) {\n          setMessages(prev => [...prev, newMsg])\n          messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\n\n          if (newMsg.recipient_id === user.id) {\n            supabase\n              .from('messages')\n              .update({ read: true })\n              .eq('id', newMsg.id)\n              .then()\n          }\n        }\n      })\n      .subscribe()\n\n    return () => {\n      supabase.removeChannel(channel)\n    }\n  }, [user, selectedUserId])\n\n  /**\n   * SEND MESSAGE\n   */\n  const handleSendMessage = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!user || !selectedUserId || !newMessage.trim()) return\n\n    const { error } = await supabase\n      .from('messages')\n      .insert({\n        sender_id: user.id,\n        recipient_id: selectedUserId,\n        content: newMessage.trim()\n      })\n\n    if (error) {\n      console.error('Error:', error)\n      return\n    }\n\n    setNewMessage('')\n  }\n\n  if (loading) {\n    return <div className=\"flex items-center justify-center min-h-screen\"><div>Loading...</div></div>\n  }\n\n  const selectedUser = users.find(u => u.user_id === selectedUserId)\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-8\">\n      <div className=\"container mx-auto max-w-6xl\">\n        <h1 className=\"text-4xl font-bold mb-8\">Messages</h1>\n\n        <div className=\"grid grid-cols-4 gap-6 h-[600px]\">\n          {/* User List */}\n          <div className=\"col-span-1 bg-white rounded-lg shadow overflow-y-auto\">\n            <div className=\"p-4 border-b\"><h2 className=\"font-semibold\">Users</h2></div>\n\n            {users.map(u => (\n              <button\n                key={u.id}\n                onClick={() => setSelectedUserId(u.user_id)}\n                className={`w-full p-4 text-left hover:bg-gray-50 ${\n                  selectedUserId === u.user_id ? 'bg-purple-50' : ''\n                }`}\n              >\n                {u.display_name || 'User'}\n              </button>\n            ))}\n          </div>\n\n          {/* Conversation */}\n          <div className=\"col-span-3 bg-white rounded-lg shadow flex flex-col\">\n            {selectedUser ? (\n              <>\n                <div className=\"p-4 border-b\">\n                  <h2 className=\"font-semibold\">{selectedUser.display_name || 'User'}</h2>\n                </div>\n\n                <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n                  {messages.map(msg => (\n                    <div\n                      key={msg.id}\n                      className={`flex ${msg.sender_id === user?.id ? 'justify-end' : 'justify-start'}`}\n                    >\n                      <div\n                        className={`max-w-[70%] px-4 py-2 rounded-lg ${\n                          msg.sender_id === user?.id\n                            ? 'bg-purple-600 text-white'\n                            : 'bg-gray-200'\n                        }`}\n                      >\n                        <p>{msg.content}</p>\n                        <div className=\"text-xs mt-1 opacity-70\">\n                          {new Date(msg.created_at).toLocaleTimeString()}\n                          {msg.sender_id === user?.id && msg.read && ' ‚Ä¢ Read'}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                  <div ref={messagesEndRef} />\n                </div>\n\n                <form onSubmit={handleSendMessage} className=\"p-4 border-t\">\n                  <div className=\"flex gap-2\">\n                    <input\n                      type=\"text\"\n                      value={newMessage}\n                      onChange={(e) => setNewMessage(e.target.value)}\n                      placeholder=\"Type a message...\"\n                      className=\"flex-1 px-4 py-2 border rounded-lg\"\n                    />\n                    <button\n                      type=\"submit\"\n                      disabled={!newMessage.trim()}\n                      className=\"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400\"\n                    >\n                      Send\n                    </button>\n                  </div>\n                </form>\n              </>\n            ) : (\n              <div className=\"flex items-center justify-center h-full text-gray-500\">\n                Select a user to start messaging\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n// CLOSE: messages-page-component\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/Settings.tsx",
      "content": "/**\n * REF: User Settings and Preferences Page\n *\n * Allows authenticated users to manage profile, appearance settings, and accessibility options.\n * Stores settings in PostgreSQL and uploads files to Supabase Storage.\n *\n * CLOSE: Protected page for managing user preferences and profile picture.\n * Settings are persisted in database and applied to the DOM.\n *\n * PAGE STRUCTURE:\n * | `Section` | Purpose |\n * |---------|---------|\n * | `Profile` | Upload profile picture |\n * | `Appearance` | Theme and font size selection |\n * | `Accessibility` | High contrast and reduced motion |\n *\n * SETTINGS SECTIONS:\n * | `Section` | `Settings` | `Storage` |\n * |---------|----------|---------|\n * | `Profile` | Avatar image | Supabase Storage |\n * | `Appearance` | theme, font_size | user_settings table |\n * | `Accessibility` | high_contrast, reduced_motion | user_settings table |\n *\n * ## Database Schema\n * ```sql\n * CREATE TABLE user_settings (\n *   id SERIAL PRIMARY KEY,\n *   user_id UUID REFERENCES auth.users,\n *   theme TEXT DEFAULT 'light',\n *   font_size TEXT DEFAULT 'medium',\n *   high_contrast BOOLEAN DEFAULT false,\n *   reduced_motion BOOLEAN DEFAULT false,\n *   updated_at TIMESTAMP DEFAULT NOW()\n * )\n * ```\n *\n * THEME OPTIONS:\n * | `Value` | Purpose |\n * |-------|---------|\n * | `light` | Standard light background |\n * | `dark` | Dark mode for reduced eye strain |\n *\n * FONT SIZES:\n * | `Value` | `Size` |\n * |-------|------|\n * | `small` | 12px |\n * | `medium` | 16px (default) |\n * | `large` | 20px |\n *\n * ## Accessibility Features\n * | Setting | Purpose |\n * |---------|---------|\n * | `high_contrast` | Increase color contrast for readability |\n * | `reduced_motion` | Disable animations for motion sensitivity |\n *\n * PROFILE PICTURE UPLOAD:\n * - Bucket: \"avatars\" in Supabase Storage\n * - Path: profile-pictures/{user_id}/{timestamp}_{filename}\n * - Validation: Image MIME type only\n * - Error handling: Shows message on failure\n * - Success: Displays success message for 2 seconds\n *\n * SETTINGS UPDATE FLOW:\n * 1. User clicks setting (button or toggle)\n * 2. handleUpdateSetting called\n * 3. Optimistic update (set state immediately)\n * 4. Call supabase.from('user_settings').update()\n * 5. If error, revert to previous state\n * 6. Show \"Saved!\" message for 2 seconds\n *\n * ## DOM Manipulation\n * ```typescript\n * // Apply theme\n * document.body.classList.toggle('dark', settings.theme === 'dark')\n *\n * // Apply font size\n * document.body.classList.remove('font-small', 'font-medium', 'font-large')\n * document.body.classList.add(`font-${settings.font_size}`)\n *\n * // Apply accessibility\n * document.body.classList.toggle('high-contrast', settings.high_contrast)\n * document.body.classList.toggle('reduced-motion', settings.reduced_motion)\n * ```\n *\n * STATE MANAGEMENT:\n * | `State` | Type | Purpose |\n * |-------|------|---------|\n * | `settings` | `object` | Current user settings |\n * | `loading` | `boolean` | Initial load |\n * | `uploading` | `boolean` | File upload in progress |\n * | `message` | `string` | Success/error message |\n *\n * SUPABASE OPERATIONS:\n * ```typescript\n * // Load settings\n * .from('user_settings')\n *   .select('*')\n *   .eq('user_id', user.id)\n *   .single()\n *\n * // Update setting\n * .from('user_settings')\n *   .update({ [field]: value })\n *   .eq('user_id', user.id)\n *\n * // Upload image\n * .storage\n *   .from('avatars')\n *   .upload(path, file)\n * ```\n *\n * FILE REFERENCES:\n * - ../lib/supabase.ts - Supabase client\n * - ../contexts/AuthContext.tsx - useAuth() hook\n * - ../App.tsx - Route definition\n *\n * ## Key Concepts\n * - Settings persistence in database\n * - File uploads to cloud storage\n * - DOM class manipulation for themes\n * - Optimistic updates (instant UI feedback)\n * - Error recovery (revert on failure)\n * - User preferences management\n * - Accessibility-first design\n */\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '../contexts/AuthContext'\nimport { supabase } from '../lib/supabase'\n\n/**\n * REF: settings-page-component\n */\nexport default function Settings() {\n  const { user } = useAuth()\n\n  const [settings, setSettings] = useState<any>(null)\n  const [loading, setLoading] = useState(true)\n  const [uploading, setUploading] = useState(false)\n  const [message, setMessage] = useState('')\n\n  /**\n   * LOAD SETTINGS FROM POSTGRESQL\n   */\n  useEffect(() => {\n    if (!user) return\n\n    const loadSettings = async () => {\n      const { data } = await supabase\n        .from('user_settings')\n        .select('*')\n        .eq('user_id', user.id)\n        .single()\n\n      setSettings(data || {\n        theme: 'light',\n        font_size: 'medium',\n        high_contrast: false,\n        reduced_motion: false\n      })\n      setLoading(false)\n    }\n\n    loadSettings()\n  }, [user])\n\n  /**\n   * APPLY SETTINGS\n   */\n  useEffect(() => {\n    if (!settings) return\n\n    const body = document.body\n\n    body.classList.toggle('dark', settings.theme === 'dark')\n    body.classList.remove('font-small', 'font-medium', 'font-large')\n    body.classList.add(`font-${settings.font_size}`)\n    body.classList.toggle('high-contrast', settings.high_contrast)\n    body.classList.toggle('reduced-motion', settings.reduced_motion)\n  }, [settings])\n\n  /**\n   * UPDATE SETTING\n   */\n  const handleUpdateSetting = async (field: string, value: any) => {\n    if (!user || !settings) return\n\n    const prev = { ...settings }\n    setSettings({ ...settings, [field]: value })\n\n    try {\n      const { error } = await supabase\n        .from('user_settings')\n        .update({ [field]: value })\n        .eq('user_id', user.id)\n\n      if (error) throw error\n\n      setMessage('Saved!')\n      setTimeout(() => setMessage(''), 2000)\n    } catch (error) {\n      setSettings(prev)\n      setMessage('Failed to save')\n      console.error(error)\n    }\n  }\n\n  /**\n   * UPLOAD PROFILE PICTURE\n   */\n  const handleUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!user || !e.target.files?.[0]) return\n\n    const file = e.target.files[0]\n\n    if (!file.type.startsWith('image/')) {\n      setMessage('Please select an image')\n      return\n    }\n\n    setUploading(true)\n\n    try {\n      const path = `profile-pictures/${user.id}/${Date.now()}_${file.name}`\n\n      await supabase.storage.from('avatars').upload(path, file)\n\n      setMessage('Profile picture updated!')\n      setTimeout(() => setMessage(''), 2000)\n    } catch (error: any) {\n      setMessage(error.message || 'Upload failed')\n    } finally {\n      setUploading(false)\n    }\n  }\n\n  if (loading) {\n    return <div className=\"flex items-center justify-center min-h-screen\"><div>Loading...</div></div>\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-8\">\n      <div className=\"container mx-auto max-w-3xl\">\n        <h1 className=\"text-4xl font-bold mb-8\">Settings</h1>\n\n        {message && (\n          <div className={`mb-6 p-4 rounded-lg ${\n            message.includes('Saved') || message.includes('updated')\n              ? 'bg-green-100 text-green-800'\n              : 'bg-red-100 text-red-800'\n          }`}>\n            {message}\n          </div>\n        )}\n\n        {/* Profile */}\n        <div className=\"bg-white rounded-lg shadow p-6 mb-6\">\n          <h2 className=\"text-2xl font-bold mb-4\">Profile</h2>\n          <div>\n            <label className=\"block text-sm font-medium mb-2\">Profile Picture</label>\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleUpload}\n              disabled={uploading}\n              className=\"w-full\"\n            />\n          </div>\n        </div>\n\n        {/* Appearance */}\n        <div className=\"bg-white rounded-lg shadow p-6 mb-6\">\n          <h2 className=\"text-2xl font-bold mb-4\">Appearance</h2>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">Theme</label>\n              <div className=\"flex gap-4\">\n                {['light', 'dark'].map(theme => (\n                  <button\n                    key={theme}\n                    onClick={() => handleUpdateSetting('theme', theme)}\n                    className={`px-6 py-3 rounded-lg border-2 capitalize ${\n                      settings.theme === theme\n                        ? 'border-purple-600 bg-purple-50'\n                        : 'border-gray-300'\n                    }`}\n                  >\n                    {theme}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">Font Size</label>\n              <div className=\"flex gap-4\">\n                {['small', 'medium', 'large'].map(size => (\n                  <button\n                    key={size}\n                    onClick={() => handleUpdateSetting('font_size', size)}\n                    className={`px-6 py-3 rounded-lg border-2 capitalize ${\n                      settings.font_size === size\n                        ? 'border-purple-600 bg-purple-50'\n                        : 'border-gray-300'\n                    }`}\n                  >\n                    {size}\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Accessibility */}\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-2xl font-bold mb-4\">Accessibility</h2>\n\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n              <div>\n                <h3 className=\"font-medium\">High Contrast</h3>\n                <p className=\"text-sm text-gray-600\">Increase contrast</p>\n              </div>\n              <button\n                onClick={() => handleUpdateSetting('high_contrast', !settings.high_contrast)}\n                className={`relative inline-flex h-6 w-11 items-center rounded-full ${\n                  settings.high_contrast ? 'bg-purple-600' : 'bg-gray-300'\n                }`}\n              >\n                <span\n                  className={`inline-block h-4 w-4 rounded-full bg-white transition ${\n                    settings.high_contrast ? 'translate-x-6' : 'translate-x-1'\n                  }`}\n                />\n              </button>\n            </div>\n\n            <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n              <div>\n                <h3 className=\"font-medium\">Reduce Motion</h3>\n                <p className=\"text-sm text-gray-600\">Minimize animations</p>\n              </div>\n              <button\n                onClick={() => handleUpdateSetting('reduced_motion', !settings.reduced_motion)}\n                className={`relative inline-flex h-6 w-11 items-center rounded-full ${\n                  settings.reduced_motion ? 'bg-purple-600' : 'bg-gray-300'\n                }`}\n              >\n                <span\n                  className={`inline-block h-4 w-4 rounded-full bg-white transition ${\n                    settings.reduced_motion ? 'translate-x-6' : 'translate-x-1'\n                  }`}\n                />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n// CLOSE: settings-page-component\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/SignIn.tsx",
      "content": "/**\n * REF: Sign In Authentication Page\n *\n * Login form for existing users. Authenticates with Supabase and creates session.\n * Accessible publicly, redirects to dashboard on successful login.\n *\n * CLOSE: User arrives here to log in with email and password.\n * On success, redirects to /dashboard. On error, displays error message.\n *\n * PAGE COMPONENTS:\n * | `Component` | Purpose |\n * |-----------|---------|\n * | Form Card | Centered white form container |\n * | Email Input | User email field |\n * | Password Input | Password field with mask |\n * | Submit Button | \"Sign In\" or \"Signing in...\" during load |\n * | Error Alert | Red error message if login fails |\n * | Sign Up Link | Navigation to /signup for new users |\n *\n * FORM FLOW:\n * 1. User enters email and password\n * 2. Clicks \"Sign In\" button\n * 3. Form calls handleSubmit\n * 4. Sets loading=true, clears error\n * 5. Calls signIn() from AuthContext\n * 6. AuthContext calls supabase.auth.signInWithPassword()\n * 7. Supabase validates credentials and returns JWT\n * 8. Session stored in localStorage\n * 9. onAuthStateChange fires in AuthContext\n * 10. useAuth hook re-renders with user data\n * 11. navigate('/dashboard') redirects to dashboard\n *\n * STATE MANAGEMENT:\n * | `State` | Type | Purpose |\n * |-------|------|---------|\n * | `email` | `string` | Form input |\n * | `password` | `string` | Form input |\n * | `error` | `string` | Error message display |\n * | `loading` | `boolean` | Disable button during submission |\n *\n * ## Error Handling\n * | `Error` | `Cause` | `Message` |\n * |-------|-------|---------|\n * | Invalid credentials | Wrong password | \"Invalid login credentials\" |\n * | Email not found | User doesn't exist | \"Invalid login credentials\" |\n * | Account not verified | Email not confirmed | \"Email not confirmed\" |\n * | Rate limit exceeded | Too many attempts | \"Too many requests\" |\n * | Network error | No internet | Error message from Supabase |\n *\n * ## Validation\n * - Email required (HTML5)\n * - Password required (HTML5)\n * - No client-side format validation (server handles)\n *\n * ## Styling\n * - Centered full-screen form\n * - White card with shadow\n * - Blue submit button with hover effect\n * - Responsive padding and sizing\n * - Tailwind CSS utility classes\n *\n * SUPABASE AUTH:\n * ```typescript\n * const { error } = await supabase.auth.signInWithPassword({\n *   email: 'user@example.com',\n *   password: 'password123'\n * })\n * ```\n *\n * ## Navigation\n * - Success: navigate('/dashboard')\n * - New user: Link to '/signup'\n * - Back button: Handled by React Router\n *\n * FILE REFERENCES:\n * - ../contexts/AuthContext.tsx - useAuth() hook\n * - ../App.tsx - Route definition\n * - SignUp.tsx - Registration page\n *\n * ## Key Concepts\n * - Client-side form submission\n * - No server validation (Supabase validates)\n * - Session automatically managed\n * - JWT tokens stored in localStorage\n * - Async password hashing (Bcrypt via Supabase)\n */\n\nimport { useState, FormEvent } from 'react'\nimport { useNavigate, Link } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\n\n/**\n * REF: signin-page-component\n */\nexport default function SignIn() {\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n\n  const { signIn } = useAuth()\n  const navigate = useNavigate()\n\n  /**\n   * HANDLE SIGN IN\n   *\n   * Authenticates with Supabase\n   *\n   * ## Flow\n   * 1. User submits form\n   * 2. Call Supabase signInWithPassword\n   * 3. Session stored in localStorage\n   * 4. Auth context updates\n   * 5. Navigate to dashboard\n   */\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault()\n    setError('')\n    setLoading(true)\n\n    try {\n      await signIn(email, password)\n      navigate('/dashboard')\n    } catch (err: any) {\n      /**\n       * SUPABASE ERROR HANDLING\n       *\n       * Common errors:\n       * - \"Invalid login credentials\"\n       * - \"Email not confirmed\"\n       * - \"Too many requests\"\n       */\n      setError(err.message || 'Failed to sign in')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center p-4 bg-gray-50\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"bg-white rounded-lg shadow-lg p-8\">\n          <h1 className=\"text-3xl font-bold text-center mb-6\">Sign In</h1>\n\n          {error && (\n            <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n              {error}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium mb-2\">\n                Email\n              </label>\n              <input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"you@example.com\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium mb-2\">\n                Password\n              </label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition\"\n            >\n              {loading ? 'Signing in...' : 'Sign In'}\n            </button>\n          </form>\n\n          <p className=\"text-center mt-6 text-gray-600\">\n            Don't have an account?{' '}\n            <Link to=\"/signup\" className=\"text-blue-600 hover:underline\">\n              Sign up\n            </Link>\n          </p>\n        </div>\n      </div>\n    </div>\n  )\n}\n// CLOSE: signin-page-component\n\n/**\n * SUPABASE AUTH IN SPA\n *\n * Session management:\n * - Tokens in localStorage\n * - Auto-refresh before expiry\n * - Syncs across tabs\n * - Works offline (cached)\n *\n * Compared to cookies (Next.js):\n * - localStorage: Client-side only, works in SPA\n * - Cookies: Server-side accessible, better for SSR\n */\n",
      "language": "typescript"
    },
    {
      "path": "src/pages/SignUp.tsx",
      "content": "/**\n * REF: Sign Up Registration Page\n *\n * Account creation form for new users. Validates input, creates Supabase user,\n * and redirects to dashboard on success.\n *\n * CLOSE: New users fill this form to create an account.\n * On success, automatically logs in and navigates to /dashboard.\n *\n * PAGE STRUCTURE:\n * | `Component` | Purpose |\n * |-----------|---------|\n * | Display Name | Optional user display name |\n * | Email Input | Registration email |\n * | Password Input | Password field (min 6 chars) |\n * | Confirm Password | Verify password matches |\n * | Submit Button | \"Sign Up\" or \"Creating account...\" during load |\n * | Error Alert | Red error message if signup fails |\n * | Sign In Link | Link to /signin for existing users |\n *\n * FORM FLOW:\n * 1. User fills in all fields\n * 2. Validates password length (min 6)\n * 3. Validates password confirmation match\n * 4. Clicks \"Sign Up\" button\n * 5. handleSubmit validates frontend\n * 6. Calls signUp() from AuthContext\n * 7. AuthContext calls supabase.auth.signUp()\n * 8. Supabase creates user and stores metadata\n * 9. Session created (auto-signin)\n * 10. onAuthStateChange fires\n * 11. User profile created in database\n * 12. navigate('/dashboard') redirects\n *\n * ### Validation Rules\n * | `Field` | `Rule` | `Error` |\n * |-------|------|-------|\n * | `Email` | Valid email format | HTML5 validation |\n * | `Password` | Min 6 characters | Client-side check |\n * | `Password` | Match confirmation | \"Passwords do not match\" |\n * | Display Name | `Optional` | No validation |\n *\n * STATE MANAGEMENT:\n * | `State` | Type | Purpose |\n * |-------|------|---------|\n * | `email` | `string` | Email input |\n * | `password` | `string` | Password input |\n * | `confirmPassword` | `string` | Confirm password input |\n * | `displayName` | `string` | User's display name |\n * | `error` | `string` | Error message |\n * | `loading` | `boolean` | Disable button during submission |\n *\n * ## Error Handling\n * | `Error` | `Cause` | `Message` |\n * |-------|-------|---------|\n * | Validation failed | Password < 6 | \"Password must be at least 6 characters\" |\n * | Passwords differ | Don't match | \"Passwords do not match\" |\n * | Email exists | Already registered | \"User already registered\" |\n * | Invalid email | Bad format | Email validation error |\n * | Server error | Database error | Server error message |\n *\n * PASSWORD REQUIREMENTS:\n * - Minimum 6 characters (Supabase default)\n * - No special character requirements\n * - No uppercase/lowercase requirements\n * - No number requirements\n * (Server can enforce stricter rules)\n *\n * METADATA STORAGE:\n * ```typescript\n * await signUp(email, password, {\n *   displayName: 'John Doe'  // Stored in user_metadata\n * })\n * ```\n * Later accessible via:\n * ```typescript\n * user.user_metadata.displayName\n * ```\n *\n * USER PROFILE CREATION:\n * - AuthContext listens for SIGNED_IN event\n * - Creates row in user_profiles table\n * - Stores display_name and user_id\n * - Initializes user_settings with defaults\n *\n * ## Styling\n * - Centered full-screen form\n * - White card with shadow\n * - Blue submit button with loading state\n * - Helper text for password minimum\n * - Red error alert box\n * - Responsive layout\n *\n * ## Navigation\n * - Success: navigate('/dashboard')\n * - Existing user: Link to '/signin'\n *\n * FILE REFERENCES:\n * - ../contexts/AuthContext.tsx - signUp() method\n * - ../App.tsx - Route definition\n * - SignIn.tsx - Login page\n *\n * ## Key Concepts\n * - Client-side form validation\n * - Server validates email/password format\n * - Metadata for non-auth user data\n * - Auto-login after signup\n * - Password confirmation pattern\n * - Error recovery (keeps form data)\n */\n\nimport { useState, FormEvent } from 'react'\nimport { useNavigate, Link } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\n\n/**\n * REF: signup-page-component\n */\nexport default function SignUp() {\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [confirmPassword, setConfirmPassword] = useState('')\n  const [displayName, setDisplayName] = useState('')\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n\n  const { signUp } = useAuth()\n  const navigate = useNavigate()\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault()\n    setError('')\n\n    if (password !== confirmPassword) {\n      setError('Passwords do not match')\n      return\n    }\n\n    if (password.length < 6) {\n      setError('Password must be at least 6 characters')\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      await signUp(email, password, { displayName })\n      navigate('/dashboard')\n    } catch (err: any) {\n      setError(err.message || 'Failed to create account')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center p-4 bg-gray-50\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"bg-white rounded-lg shadow-lg p-8\">\n          <h1 className=\"text-3xl font-bold text-center mb-6\">Create Account</h1>\n\n          {error && (\n            <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n              {error}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"displayName\" className=\"block text-sm font-medium mb-2\">\n                Display Name\n              </label>\n              <input\n                id=\"displayName\"\n                type=\"text\"\n                value={displayName}\n                onChange={(e) => setDisplayName(e.target.value)}\n                className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"John Doe\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium mb-2\">\n                Email\n              </label>\n              <input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"you@example.com\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium mb-2\">\n                Password\n              </label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                minLength={6}\n                className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              />\n              <p className=\"text-xs text-gray-500 mt-1\">Minimum 6 characters</p>\n            </div>\n\n            <div>\n              <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium mb-2\">\n                Confirm Password\n              </label>\n              <input\n                id=\"confirmPassword\"\n                type=\"password\"\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                required\n                className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition\"\n            >\n              {loading ? 'Creating account...' : 'Sign Up'}\n            </button>\n          </form>\n\n          <p className=\"text-center mt-6 text-gray-600\">\n            Already have an account?{' '}\n            <Link to=\"/signin\" className=\"text-blue-600 hover:underline\">\n              Sign in\n            </Link>\n          </p>\n        </div>\n      </div>\n    </div>\n  )\n}\n// CLOSE: signup-page-component\n",
      "language": "typescript"
    },
    {
      "path": "src/types/index.ts",
      "content": "/**\n * REF: shared-types-supabase\n *\n * # Shared Type Definitions\n *\n * Central type definitions for React + Vite + Supabase application.\n */\n\n/**\n * REF: attachment-interface-supabase\n *\n * ## Attachment Interface\n */\nexport interface Attachment {\n  fileName: string\n  fileUrl: string\n  fileSize: number\n  mimeType: string\n  uploadedAt?: string\n}\n// CLOSE: attachment-interface-supabase\n\n/**\n * REF: todo-interface-supabase\n *\n * ## Todo Interface\n */\nexport interface Todo {\n  id: string\n  user_id: string\n  title: string\n  description?: string\n  completed: boolean\n  is_public: boolean\n  tags?: string[]\n  attachments?: Attachment[]\n  created_at: string\n  updated_at: string\n}\n// CLOSE: todo-interface-supabase\n\n/**\n * REF: user-interface-supabase\n *\n * ## User Interface\n */\nexport interface User {\n  id: string\n  email: string\n  display_name?: string\n  photo_url?: string\n  created_at: string\n}\n// CLOSE: user-interface-supabase\n\n/**\n * REF: message-interface-supabase\n *\n * ## Message Interface\n */\nexport interface Message {\n  id: string\n  sender_id: string\n  recipient_id: string\n  content: string\n  read: boolean\n  read_at?: string\n  created_at: string\n}\n// CLOSE: message-interface-supabase\n\n/**\n * REF: settings-interface-supabase\n *\n * ## Settings Interface\n */\nexport interface Settings {\n  user_id: string\n  theme: 'light' | 'dark'\n  font_size: 'small' | 'medium' | 'large'\n  high_contrast: boolean\n  reduced_motion: boolean\n}\n// CLOSE: settings-interface-supabase\n// CLOSE: shared-types-supabase\n",
      "language": "typescript"
    },
    {
      "path": "tailwind.config.js",
      "content": "/**\n * REF: Tailwind CSS Configuration\n *\n * Configures Tailwind CSS utility-first framework for the React application.\n * Defines content scanning, dark mode, theme customization, and plugin setup.\n *\n * CLOSE: Tailwind reads this config at build time to generate CSS.\n * Scans specified files for class usage and tree-shakes unused styles.\n *\n * CONFIGURATION SECTIONS:\n * | Section | Purpose |\n * |---------|---------|\n * | content | File paths to scan for classes |\n * | darkMode | Dark mode strategy |\n * | theme | Design tokens (colors, fonts, spacing) |\n * | theme.extend | Add custom tokens without replacing defaults |\n * | plugins | Third-party Tailwind extensions |\n *\n * CONTENT PATHS:\n * ```javascript\n * content: [\n *   './index.html',              // Root HTML file\n *   './src/**\\/*.{js,ts,jsx,tsx}' // All source files (JS, TS, JSX, TSX)\n * ]\n * ```\n * - Tailwind scans these files for class names\n * - Unused classes are removed (tree-shaking)\n * - Keeps bundle size small\n * - Supports glob patterns\n *\n * DARK MODE STRATEGY:\n * | Value | Trigger | Usage |\n * |-------|---------|-------|\n * | 'media' | OS preference (prefers-color-scheme) | Automatic based on system |\n * | 'class' | .dark class on root element | Manual toggle via JavaScript |\n *\n * Current: 'media' (automatic dark mode based on OS)\n *\n * THEME EXTENSION:\n * - theme.extend: {} - Currently empty (using Tailwind defaults)\n * - Can add custom colors, spacing, fonts, etc.\n * - Example:\n * ```javascript\n * theme: {\n *   extend: {\n *     colors: {\n *       brand: '#7c3aed',\n *       'brand-dark': '#5b21b6'\n *     },\n *     spacing: {\n *       '128': '32rem'\n *     }\n *   }\n * }\n * ```\n *\n * PLUGINS:\n * - plugins: [] - Currently empty\n * - Common plugins:\n *   - @tailwindcss/forms - Better form styling\n *   - @tailwindcss/typography - Prose styles\n *   - @tailwindcss/aspect-ratio - Aspect ratio utilities\n *   - @tailwindcss/line-clamp - Line clamping\n *\n * BUILD PROCESS:\n * 1. Vite runs Tailwind plugin\n * 2. Tailwind reads this config file\n * 3. Scans content files for class names\n * 4. Generates CSS for used classes only\n * 5. Injects CSS into bundle\n * 6. Tree-shakes unused utilities\n * 7. Minifies for production\n *\n * PERFORMANCE:\n * - Development: Generates all utilities (~3MB uncompressed)\n * - Production: Only used classes (~5-20KB compressed)\n * - JIT (Just-In-Time) compiler for instant builds\n * - Hot reload updates CSS immediately\n *\n * UTILITY CLASSES:\n * Tailwind provides thousands of utilities:\n * - Layout: flex, grid, container, space-y-4\n * - Typography: text-xl, font-bold, leading-tight\n * - Colors: bg-purple-600, text-white, border-gray-300\n * - Spacing: p-4, m-2, gap-6\n * - Sizing: w-full, h-screen, max-w-md\n * - Effects: shadow-lg, rounded-lg, hover:bg-blue-700\n * - Responsive: sm:text-base, md:grid-cols-2, lg:px-8\n * - State: hover:, focus:, active:, disabled:\n *\n * RESPONSIVE DESIGN:\n * Default breakpoints:\n * | Prefix | Min Width | Target |\n * |--------|-----------|--------|\n * | (none) | 0px | Mobile-first base |\n * | sm: | 640px | Small tablets |\n * | md: | 768px | Tablets |\n * | lg: | 1024px | Laptops |\n * | xl: | 1280px | Desktops |\n * | 2xl: | 1536px | Large screens |\n *\n * Usage:\n * ```jsx\n * <div className=\"text-sm md:text-base lg:text-lg\">\n *   Responsive text size\n * </div>\n * ```\n *\n * DARK MODE CLASSES:\n * With darkMode: 'media':\n * ```jsx\n * <div className=\"bg-white dark:bg-gray-900\">\n *   Automatically switches based on OS preference\n * </div>\n * ```\n *\n * CUSTOMIZATION EXAMPLES:\n * Add custom theme values:\n * ```javascript\n * theme: {\n *   extend: {\n *     colors: {\n *       'todo-purple': '#7c3aed'\n *     },\n *     fontFamily: {\n *       sans: ['Inter', 'sans-serif']\n *     },\n *     borderRadius: {\n *       'xl': '1rem'\n *     }\n *   }\n * }\n * ```\n *\n * FILE REFERENCES:\n * - src/index.css - Imports Tailwind directives\n * - vite.config.ts - Vite processes Tailwind CSS\n * - postcss.config.js - PostCSS configuration for Tailwind\n *\n * KEY CONCEPTS:\n * - Utility-first CSS framework\n * - JIT (Just-In-Time) compilation\n * - Tree-shaking removes unused styles\n * - Mobile-first responsive design\n * - Automatic dark mode support\n * - No custom CSS needed (utilities cover most cases)\n * - Smaller bundle size vs traditional CSS\n * - Consistent design tokens\n */\n\n/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\n    './index.html',\n    './src/**/*.{js,ts,jsx,tsx}',\n  ],\n  darkMode: 'media',\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}\n\n/**\n * TAILWIND IN PRODUCTION\n *\n * Build output:\n * - Scans all files in content array\n * - Extracts class names used\n * - Generates CSS for those classes only\n * - Minifies and compresses\n * - Typical size: 5-15KB gzipped\n *\n * Compare to Bootstrap (~50KB gzipped):\n * - Tailwind: Only what you use\n * - Bootstrap: Everything whether you use it or not\n */\n\n/**\n * POSTCSS INTEGRATION\n *\n * Tailwind uses PostCSS:\n * - Processes @tailwind directives\n * - Injects generated utilities\n * - Applies autoprefixer\n * - Minifies in production\n *\n * See postcss.config.js for configuration\n */\n\n/**\n * VITE + TAILWIND\n *\n * In development:\n * - Instant HMR for CSS changes\n * - JIT generates classes on-demand\n * - No need to rebuild entire CSS\n * - See changes immediately\n *\n * In production:\n * - npm run build\n * - Tailwind purges unused styles\n * - CSS minified and hashed\n * - Ready for deployment\n */\n",
      "language": "javascript"
    },
    {
      "path": "vite.config.ts",
      "content": "/**\n * REF: Vite Build Configuration\n *\n * Configures Vite bundler for React development and production builds.\n * Includes optimizations for Supabase client and React library.\n *\n * CLOSE: Vite reads this file automatically. Configuration handles development server,\n * build optimization, plugin setup, and path aliases.\n *\n * ## Configuration Sections\n * | `Section` | Purpose |\n * |---------|---------|\n * | `plugins` | Register Vite plugins (React, etc) |\n * | `resolve` | Module resolution and aliases |\n * | `server` | Development server settings |\n * | `build` | Production build optimization |\n *\n * ## Plugins\n * ```typescript\n * plugins: [react()]\n * ```\n * - @vitejs/plugin-react: Handles JSX transformation and Fast Refresh\n * - Fast Refresh: Preserves component state during edits\n *\n * RESOLVE CONFIGURATION:\n * ```typescript\n * resolve: {\n *   alias: {\n *     '@': path.resolve(__dirname, './src')  // @/components -> src/components\n *   }\n * }\n * ```\n * - Allows importing with @ prefix for shorter paths\n * - Usage: `import Foo from '@/components/Foo'`\n * - vs: `import Foo from '../../../components/Foo'`\n *\n * ## Development Server\n * ```typescript\n * server: {\n *   port: 5173,\n *   open: true  // Auto-open browser on npm run dev\n * }\n * ```\n * - port: 5173 (Vite default, change if needed)\n * - open: true opens browser automatically\n * - HMR (Hot Module Replacement) enabled by default\n *\n * ## Build Configuration\n * | `Option` | `Value` | Purpose |\n * |--------|-------|---------|\n * | `outDir` | `'dist'` | Output folder for production build |\n * | `sourcemap` | `true` | Generate source maps for debugging |\n * | `rollupOptions.output.manualChunks` | {...} | Code splitting strategy |\n *\n * ## Code Splitting Strategy\n * ```typescript\n * manualChunks: {\n *   'react-vendor': ['react', 'react-dom', 'react-router-dom'],\n *   'supabase-vendor': ['@supabase/supabase-js']\n * }\n * ```\n * - Separates large libraries into separate bundle chunks\n * - Benefits: Better caching, parallel loading, smaller app bundle\n * - react-vendor: ~180KB\n * - supabase-vendor: ~200KB\n * - main app: ~50KB (example)\n *\n * ## Build Output\n * After `npm run build`:\n * ```\n * dist/\n *   ‚îú‚îÄ index.html (entry point)\n *   ‚îî‚îÄ assets/\n *       ‚îú‚îÄ react-vendor-abc123.js\n *       ‚îú‚îÄ supabase-vendor-def456.js\n *       ‚îú‚îÄ index-ghi789.js\n *       ‚îî‚îÄ style-jkl012.css\n * ```\n *\n * HASHED FILENAMES:\n * - Content-based hashes (abc123, def456, etc)\n * - Changes to code = different hash\n * - Enables long-term caching\n * - CDN/browser cache files forever\n * - Updates automatically detected by new hash\n *\n * ## Development Workflow\n * 1. `npm run dev` starts Vite dev server\n * 2. Open http://localhost:5173 in browser\n * 3. Edit code, save file\n * 4. Vite detects change\n * 5. Module reloaded via HMR\n * 6. Browser updates instantly\n * 7. Component state preserved (Fast Refresh)\n *\n * PRODUCTION BUILD:\n * 1. `npm run build` runs Vite production build\n * 2. Code is minified and optimized\n * 3. Unnecessary code is tree-shaken (removed)\n * 4. Output written to dist/ folder\n * 5. dist/ ready for deployment to any static host\n *\n * SUPABASE-SPECIFIC OPTIMIZATIONS:\n * - WebSocket support: Vite handles transparently\n * - Environment variables: VITE_ prefix required\n * - Realtime subscriptions: No special config needed\n * - Storage uploads: Works from browser as-is\n *\n * ## Deployment\n * Deploy `dist/` folder to:\n * - Vercel: Automatic from Git\n * - Netlify: Automatic from Git\n * - Firebase Hosting: `firebase deploy`\n * - GitHub Pages: `gh-pages` package\n * - AWS S3 + CloudFront\n * - Any static host with HTTP server\n *\n * FILE REFERENCES:\n * - package.json - npm scripts calling Vite\n * - .env - Environment variables (development)\n * - .env.production - Environment variables (production)\n *\n * ## Key Concepts\n * - Lightning-fast development (Vite uses esbuild)\n * - Instant HMR (Hot Module Replacement)\n * - Code splitting for optimal caching\n * - Tree-shaking removes unused code\n * - Sourcemaps for debugging production code\n */\n\n  /** REF: imports\n   */\nimport { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\nimport path from 'path'\n  // CLOSE: imports\n\nexport default defineConfig({\n  plugins: [react()],\n\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n\n  server: {\n    port: 5173,\n    open: true,\n  },\n\n  build: {\n    outDir: 'dist',\n    sourcemap: true,\n\n    /**\n     * SUPABASE CLIENT CHUNKING\n     *\n     * Supabase client is large (~200KB)\n     * Split into separate chunk for better caching\n     */\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          'react-vendor': ['react', 'react-dom', 'react-router-dom'],\n          'supabase-vendor': ['@supabase/supabase-js'],\n        },\n      },\n    },\n  },\n\n  /**\n   * OPTIMIZATIONS FOR SUPABASE\n   *\n   * Supabase client uses WebSockets:\n   * - Ensure WebSocket proxy configured if needed\n   * - Works out of the box in most cases\n   *\n   * Development proxy (if backend on different port):\n   * ```javascript\n   * server: {\n   *   proxy: {\n   *     '/api': {\n   *       target: 'http://localhost:3001',\n   *       changeOrigin: true,\n   *       ws: true, // Enable WebSocket proxy\n   *     },\n   *   },\n   * }\n   * ```\n   */\n})\n\n/**\n * ENVIRONMENT VARIABLES IN VITE\n *\n * Must use VITE_ prefix:\n * - VITE_SUPABASE_URL ‚úÖ\n * - SUPABASE_URL ‚ùå (won't work)\n *\n * Access in code:\n * ```typescript\n * import.meta.env.VITE_SUPABASE_URL\n * ```\n *\n * Build-time embedding:\n * - Values embedded at build time\n * - Not runtime environment variables\n * - Can't change after build\n */\n\n/**\n * SUPABASE REALTIME WEBSOCKET\n *\n * Supabase Realtime uses WebSockets\n * Vite handles this automatically in dev\n *\n * For production:\n * - Ensure hosting supports WebSockets\n * - Vercel: ‚úÖ Yes\n * - Netlify: ‚úÖ Yes\n * - Firebase Hosting: ‚úÖ Yes\n * - GitHub Pages: ‚ùå No (static only, but Supabase handles connection)\n *\n * Actually, client connects directly to Supabase,\n * so hosting doesn't need WebSocket support!\n */\n\n/**\n * BUILD PERFORMANCE\n *\n * Vite build is fast:\n * - Uses Rollup for production\n * - esbuild for dependencies\n * - Parallel processing\n * - Aggressive caching\n *\n * Typical build times:\n * - Small app: 5-10 seconds\n * - Medium app: 15-30 seconds\n * - Large app: 30-60 seconds\n *\n * Much faster than Webpack!\n */\n",
      "language": "typescript"
    }
  ]
}